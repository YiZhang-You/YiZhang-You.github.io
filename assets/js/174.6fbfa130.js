(window.webpackJsonp=window.webpackJsonp||[]).push([[174],{900:function(s,t,a){"use strict";a.r(t);var e=a(4),n=Object(e.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"链接资料"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#链接资料"}},[s._v("#")]),s._v(" 链接资料")]),s._v(" "),t("ol",[t("li",[t("p",[s._v("阮一峰的网络日志")]),s._v(" "),t("p",[t("a",{attrs:{href:"http://www.ruanyifeng.com/blog/2014/05/restful_api.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("RESTful API 设计指南"),t("OutboundLink")],1)])])]),s._v(" "),t("h2",{attrs:{id:"_1-restful-api基本介绍"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-restful-api基本介绍"}},[s._v("#")]),s._v(" 1. "),t("strong",[s._v("resTful API基本介绍")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("一句话：RESTful API是目前前后端分离的最佳实践，它是一套标准，一个规范，而不是一个框架。\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("标准对于开发者来说是十分重要的，就像HTTP、HTML这些都是标准。")]),s._v(" "),t("p",[s._v("在前后端分离的时候，我们会设计API，如果我们在设计的时候依据RESTful准则，那么这套API这可以称作RESTful API。")]),s._v(" "),t("ul",[t("li",[s._v("RESTful API轻量，直接通过http或者https，不需要额外的协议，一般有四种常用操作post/get/put/delete。")]),s._v(" "),t("li",[s._v("RESTful API面向资源，一目了然，具有自解释性。")]),s._v(" "),t("li",[s._v("RESTful API数据的描述十分简单，基于Json或XML的数据格式进行数据传输。")])]),s._v(" "),t("p",[s._v("总结什么是RESTful架构：")]),s._v(" "),t("ul",[t("li",[s._v("（1）每一个URI代表一种资源；")]),s._v(" "),t("li",[s._v("（2）客户端和服务器之间，传递这种资源的某种表现层；")]),s._v(" "),t("li",[s._v('(3）客户端通过四个HTTP动词，对服务器端资源进行操作，实现"表现层状态转化"。')])]),s._v(" "),t("h2",{attrs:{id:"_2-restful-api设计指南"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-restful-api设计指南"}},[s._v("#")]),s._v(" "),t("strong",[s._v("2. restful API设计指南")])]),s._v(" "),t("h3",{attrs:{id:"_1、协议"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1、协议"}},[s._v("#")]),s._v(" "),t("strong",[s._v("1、协议")])]),s._v(" "),t("p",[s._v("API与用户的通信协议，总是使用"),t("a",{attrs:{href:"https://gitee.com/link?target=https%3A%2F%2Fwww.ruanyifeng.com%2Fblog%2F2014%2F02%2Fssl_tls.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("HTTPs协议"),t("OutboundLink")],1)]),s._v(" "),t("p",[s._v("推荐使用 HTTPS.安全")]),s._v(" "),t("h3",{attrs:{id:"_2、域名"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2、域名"}},[s._v("#")]),s._v(" "),t("strong",[s._v("2、域名")])]),s._v(" "),t("p",[s._v("应该尽量将API部署在专用域名之下")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("<https://api.example.com>\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("如果确定API很简单，不会有进一步扩展，可以考虑放在主域名下。")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("https：//example.org/api/\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"_3、版本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3、版本"}},[s._v("#")]),s._v(" "),t("strong",[s._v("3、版本")])]),s._v(" "),t("p",[s._v("应该将API的版本号放入URL")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("<http://www.example.com/app/1.0/apples>\n<http://www.example.com/app/1.1/apples>\n<http://www.example.com/app/2.0/apples>\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("另一种做法是，将版本号放在HTTP头信息中，但不如放入URL方便和直观。"),t("a",{attrs:{href:"https://gitee.com/link?target=https%3A%2F%2Fdeveloper.github.com%2Fv3%2Fmedia%2F%23request-specific-version",target:"_blank",rel:"noopener noreferrer"}},[s._v("Github"),t("OutboundLink")],1),s._v("采用这种做法.")]),s._v(" "),t("h3",{attrs:{id:"_4、路径"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4、路径"}},[s._v("#")]),s._v(" "),t("strong",[s._v("4、路径")])]),s._v(" "),t("p",[s._v('路径又称"终点"（endpoint），表示API的具体网址')]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("GET /products ：将返回所有产品清单\nPOST /products ：将产品新建到集合\nGET /products/4 ：将获取产品4\nPATCH /products/4 将更新产品4（部分属性更新）\nPUT /products/4：将更新产品4 （全部属性更新）\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("对数据的操作增删改查 即：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("create：增\nread： 查\nupdate： 改\ndelete： 删\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[s._v("所以：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('GET: 获取资源\nPOST：新增资源\nPUT： 更新资源(全部更新) => {"id":1,"name":\'帅高高\'，"age":13}\nPATCH: 部分更新 => {"id":1,"age":13} => 选择性的更新DELETE: 删除资源\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h3",{attrs:{id:"_5、http动词"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5、http动词"}},[s._v("#")]),s._v(" "),t("strong",[s._v("5、HTTP动词")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("| 请求方法 | 请求地址    | 后端操作                     |\n| -------- | ----------- | --------------------------|\n| GET      | /students   | 获取所有学生                |\n| POST     | /students   | 增加学生                   |\n| GET      | /students/1 | 获取编号为1的学生           |\n| PUT      | /students/1 | 更新编号为1的学生（全部属性） |\n| DELETE   | /students/1 | 删除编号为1的学生        　　|\n| PATCH    | /students/1 | 更新编号为1的学生（部分属性） |\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("h3",{attrs:{id:"_6、过滤信息"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6、过滤信息"}},[s._v("#")]),s._v(" "),t("strong",[s._v("6、过滤信息")])]),s._v(" "),t("p",[s._v("如果记录数量很多，服务器不可能都将它们返回给用户。API应该提供参数，过滤返回结果。")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("?limit=10：指定返回记录的数量\n?offset=10：指定返回记录的开始位置。\n?page=2&per_page=100：指定第几页，以及每页的记录数。\n?sortby=name&order=asc：指定返回结果按照哪个属性排序，以及排序顺序。\n?animal_type_id=1：指定筛选条件\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h3",{attrs:{id:"_7、状态码"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7、状态码"}},[s._v("#")]),s._v(" "),t("strong",[s._v("7、状态码")])]),s._v(" "),t("p",[s._v("服务器向用户返回的状态码和提示信息，常见的有以下一些（方括号中是该状态码对应的HTTP动词）。")]),s._v(" "),t("ul",[t("li",[s._v("200 OK - [GET]：服务器成功返回用户请求的数据，该操作是幂等的（Idempotent）。")]),s._v(" "),t("li",[s._v("201 CREATED - [POST/PUT/PATCH]：用户新建或修改数据成功。")]),s._v(" "),t("li",[s._v("202 Accepted - [*]：表示一个请求已经进入后台排队（异步任务）")]),s._v(" "),t("li",[s._v("204 NO CONTENT - [DELETE]：用户删除数据成功。")]),s._v(" "),t("li",[s._v("400 INVALID REQUEST - [POST/PUT/PATCH]：用户发出的请求有错误，服务器没有进行新建或修改数据的操作，该操作是幂等的。")]),s._v(" "),t("li",[s._v("401 Unauthorized - [*]：表示用户没有权限（令牌、用户名、密码错误）。")]),s._v(" "),t("li",[s._v("403 Forbidden - [*] 表示用户得到授权（与401错误相对），但是访问是被禁止的。")]),s._v(" "),t("li",[s._v("404 NOT FOUND - [*]：用户发出的请求针对的是不存在的记录，服务器没有进行操作，该操作是幂等的。")]),s._v(" "),t("li",[s._v("406 Not Acceptable - [GET]：用户请求的格式不可得（比如用户请求JSON格式，但是只有XML格式）。")]),s._v(" "),t("li",[s._v("410 Gone -[GET]：用户请求的资源被永久删除，且不会再得到的。")]),s._v(" "),t("li",[s._v("422 Unprocesable entity - [POST/PUT/PATCH] 当创建一个对象时，发生一个验证错误。")]),s._v(" "),t("li",[s._v("500 INTERNAL SERVER ERROR - [*]：服务器发生错误，用户将无法判断发出的请求是否成功。")])]),s._v(" "),t("p",[s._v("状态码的完全列表参见"),t("a",{attrs:{href:"https://gitee.com/link?target=https%3A%2F%2Fwww.w3.org%2FProtocols%2Frfc2616%2Frfc2616-sec10.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("这里"),t("OutboundLink")],1),s._v("。")]),s._v(" "),t("h3",{attrs:{id:"_8、错误处理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_8、错误处理"}},[s._v("#")]),s._v(" "),t("strong",[s._v("8、错误处理")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("{\n\terror:\"Invalid API key\"\n}\n\n#移动端格式\n{\n\t'code':1,\n\t'msg':xxxx,\n\t\"data\":{}\n}\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("h3",{attrs:{id:"_9、返回结果"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_9、返回结果"}},[s._v("#")]),s._v(" "),t("strong",[s._v("9、返回结果")])]),s._v(" "),t("p",[s._v("针对不同操作，服务器向用户返回的结果应该符合以下规范。")]),s._v(" "),t("p",[s._v("REST framework返回的数据都是JSON格式的")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("GET /collection：返回资源对象的列表（数组）\nGET /collection/resource：返回单个资源对象\nPOST /collection：返回新生成的资源对象\nPUT /collection/resource：返回完整的资源对象\nPATCH /collection/resource：返回完整的资源对象\nDELETE /collection/resource：返回一个空文档\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("h3",{attrs:{id:"_10、返回结构中提供链接"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_10、返回结构中提供链接"}},[s._v("#")]),s._v(" "),t("strong",[s._v("10、返回结构中提供链接")])]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"link"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"rel"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"collection <https://www.example.com/zoos>"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"href"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"<https://api.example.com/zoos>"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"title"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"List of zoos"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"application/vnd.yourformat+json"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])])])}),[],!1,null,null,null);t.default=n.exports}}]);