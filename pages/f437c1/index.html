<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>python魔法方法 | yyz notes</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="个人笔记总结">
    <meta name="keywords" content="个人技术博客,技术文档,学习,面试">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.008dd71f.css" as="style"><link rel="preload" href="/assets/js/app.4d9762f5.js" as="script"><link rel="preload" href="/assets/js/2.eb47357b.js" as="script"><link rel="preload" href="/assets/js/151.a8a53689.js" as="script"><link rel="prefetch" href="/assets/js/10.3c51181e.js"><link rel="prefetch" href="/assets/js/100.f26be4a2.js"><link rel="prefetch" href="/assets/js/101.9a3c581e.js"><link rel="prefetch" href="/assets/js/102.fa38c999.js"><link rel="prefetch" href="/assets/js/103.e3fec62c.js"><link rel="prefetch" href="/assets/js/104.af4487f1.js"><link rel="prefetch" href="/assets/js/105.1ad2ef13.js"><link rel="prefetch" href="/assets/js/106.faa67b0b.js"><link rel="prefetch" href="/assets/js/107.f2dd57a1.js"><link rel="prefetch" href="/assets/js/108.b6bf26bd.js"><link rel="prefetch" href="/assets/js/109.b48e8d9f.js"><link rel="prefetch" href="/assets/js/11.2866fd7e.js"><link rel="prefetch" href="/assets/js/110.a303fc4b.js"><link rel="prefetch" href="/assets/js/111.c41ed6c3.js"><link rel="prefetch" href="/assets/js/112.719090d1.js"><link rel="prefetch" href="/assets/js/113.9e678799.js"><link rel="prefetch" href="/assets/js/114.466a8f38.js"><link rel="prefetch" href="/assets/js/115.b05fb5aa.js"><link rel="prefetch" href="/assets/js/116.3dc9d606.js"><link rel="prefetch" href="/assets/js/117.90bfdcc4.js"><link rel="prefetch" href="/assets/js/118.59cfc231.js"><link rel="prefetch" href="/assets/js/119.01c9510b.js"><link rel="prefetch" href="/assets/js/12.b52866fb.js"><link rel="prefetch" href="/assets/js/120.0c0d8dda.js"><link rel="prefetch" href="/assets/js/121.9397b26a.js"><link rel="prefetch" href="/assets/js/122.797e94c5.js"><link rel="prefetch" href="/assets/js/123.7b55a573.js"><link rel="prefetch" href="/assets/js/124.e7bb827b.js"><link rel="prefetch" href="/assets/js/125.c4087fd0.js"><link rel="prefetch" href="/assets/js/126.dd5f2353.js"><link rel="prefetch" href="/assets/js/127.b9228fbe.js"><link rel="prefetch" href="/assets/js/128.f0db1709.js"><link rel="prefetch" href="/assets/js/129.fdcbf978.js"><link rel="prefetch" href="/assets/js/13.94401b7a.js"><link rel="prefetch" href="/assets/js/130.a939d195.js"><link rel="prefetch" href="/assets/js/131.d57d16bc.js"><link rel="prefetch" href="/assets/js/132.f8f628f6.js"><link rel="prefetch" href="/assets/js/133.e9fa5b63.js"><link rel="prefetch" href="/assets/js/134.78681c45.js"><link rel="prefetch" href="/assets/js/135.81b0b955.js"><link rel="prefetch" href="/assets/js/136.10532595.js"><link rel="prefetch" href="/assets/js/137.438cefa0.js"><link rel="prefetch" href="/assets/js/138.857c06c7.js"><link rel="prefetch" href="/assets/js/139.b11fc012.js"><link rel="prefetch" href="/assets/js/14.0e82c877.js"><link rel="prefetch" href="/assets/js/140.2922faa0.js"><link rel="prefetch" href="/assets/js/141.d2bc6449.js"><link rel="prefetch" href="/assets/js/142.6a4f8226.js"><link rel="prefetch" href="/assets/js/143.92440abe.js"><link rel="prefetch" href="/assets/js/144.005f8068.js"><link rel="prefetch" href="/assets/js/145.a04413a1.js"><link rel="prefetch" href="/assets/js/146.dd2ee52f.js"><link rel="prefetch" href="/assets/js/147.51fab298.js"><link rel="prefetch" href="/assets/js/148.81b39c06.js"><link rel="prefetch" href="/assets/js/149.ebab7526.js"><link rel="prefetch" href="/assets/js/15.bfa39557.js"><link rel="prefetch" href="/assets/js/150.daf76e81.js"><link rel="prefetch" href="/assets/js/152.fda9dfc1.js"><link rel="prefetch" href="/assets/js/153.8a34dcb1.js"><link rel="prefetch" href="/assets/js/154.ec1d9549.js"><link rel="prefetch" href="/assets/js/155.38b9ec37.js"><link rel="prefetch" href="/assets/js/156.5bcb7c08.js"><link rel="prefetch" href="/assets/js/157.1e307044.js"><link rel="prefetch" href="/assets/js/158.a9ee901b.js"><link rel="prefetch" href="/assets/js/159.9b6eb747.js"><link rel="prefetch" href="/assets/js/16.9d885216.js"><link rel="prefetch" href="/assets/js/160.3ae584e1.js"><link rel="prefetch" href="/assets/js/161.f37a53cd.js"><link rel="prefetch" href="/assets/js/162.6b371177.js"><link rel="prefetch" href="/assets/js/163.b30c58eb.js"><link rel="prefetch" href="/assets/js/164.4b28091c.js"><link rel="prefetch" href="/assets/js/165.76bffe98.js"><link rel="prefetch" href="/assets/js/166.a4abbe88.js"><link rel="prefetch" href="/assets/js/167.d04b6e6e.js"><link rel="prefetch" href="/assets/js/168.8d51d7d9.js"><link rel="prefetch" href="/assets/js/169.0a5eb0bc.js"><link rel="prefetch" href="/assets/js/17.ba19d36d.js"><link rel="prefetch" href="/assets/js/170.79f68470.js"><link rel="prefetch" href="/assets/js/171.cd0f10cc.js"><link rel="prefetch" href="/assets/js/172.518493ce.js"><link rel="prefetch" href="/assets/js/173.e8229c4d.js"><link rel="prefetch" href="/assets/js/174.6fbfa130.js"><link rel="prefetch" href="/assets/js/175.e0ce2304.js"><link rel="prefetch" href="/assets/js/176.9d1d9fea.js"><link rel="prefetch" href="/assets/js/177.c83500c0.js"><link rel="prefetch" href="/assets/js/178.dbcfae4f.js"><link rel="prefetch" href="/assets/js/179.1effa1e2.js"><link rel="prefetch" href="/assets/js/18.a2901cf4.js"><link rel="prefetch" href="/assets/js/180.43c05bc4.js"><link rel="prefetch" href="/assets/js/181.f52816fa.js"><link rel="prefetch" href="/assets/js/182.4e19af57.js"><link rel="prefetch" href="/assets/js/183.d4427034.js"><link rel="prefetch" href="/assets/js/184.c21dbfa0.js"><link rel="prefetch" href="/assets/js/185.e03a088a.js"><link rel="prefetch" href="/assets/js/186.7124ab04.js"><link rel="prefetch" href="/assets/js/187.78745718.js"><link rel="prefetch" href="/assets/js/188.45a1da1c.js"><link rel="prefetch" href="/assets/js/189.02b24b8e.js"><link rel="prefetch" href="/assets/js/19.4597f9a2.js"><link rel="prefetch" href="/assets/js/190.f277917e.js"><link rel="prefetch" href="/assets/js/191.defadabb.js"><link rel="prefetch" href="/assets/js/192.c9f3d038.js"><link rel="prefetch" href="/assets/js/193.348c260e.js"><link rel="prefetch" href="/assets/js/194.f2d6f04f.js"><link rel="prefetch" href="/assets/js/195.42665099.js"><link rel="prefetch" href="/assets/js/196.bf1e8775.js"><link rel="prefetch" href="/assets/js/197.4a4a7d1b.js"><link rel="prefetch" href="/assets/js/198.035c6a9f.js"><link rel="prefetch" href="/assets/js/199.4acb7c37.js"><link rel="prefetch" href="/assets/js/20.9c008052.js"><link rel="prefetch" href="/assets/js/200.80704d62.js"><link rel="prefetch" href="/assets/js/201.ad42732d.js"><link rel="prefetch" href="/assets/js/202.a1461cd3.js"><link rel="prefetch" href="/assets/js/203.9547a3f3.js"><link rel="prefetch" href="/assets/js/204.e0bb1b43.js"><link rel="prefetch" href="/assets/js/205.17624b50.js"><link rel="prefetch" href="/assets/js/206.452e0af0.js"><link rel="prefetch" href="/assets/js/207.74bd8f02.js"><link rel="prefetch" href="/assets/js/208.adcbd4e7.js"><link rel="prefetch" href="/assets/js/209.d288a1ff.js"><link rel="prefetch" href="/assets/js/21.4236593f.js"><link rel="prefetch" href="/assets/js/210.7b4a2df1.js"><link rel="prefetch" href="/assets/js/211.9ea3b546.js"><link rel="prefetch" href="/assets/js/212.00bd6213.js"><link rel="prefetch" href="/assets/js/213.57599d6b.js"><link rel="prefetch" href="/assets/js/214.a648b4d6.js"><link rel="prefetch" href="/assets/js/215.07ddb469.js"><link rel="prefetch" href="/assets/js/216.d418e120.js"><link rel="prefetch" href="/assets/js/217.c41e8158.js"><link rel="prefetch" href="/assets/js/218.e664ccb4.js"><link rel="prefetch" href="/assets/js/219.00e5a892.js"><link rel="prefetch" href="/assets/js/22.f3337ef6.js"><link rel="prefetch" href="/assets/js/220.9f5b66e2.js"><link rel="prefetch" href="/assets/js/221.5e6a6668.js"><link rel="prefetch" href="/assets/js/222.a5989026.js"><link rel="prefetch" href="/assets/js/223.315a7414.js"><link rel="prefetch" href="/assets/js/224.d699eb73.js"><link rel="prefetch" href="/assets/js/225.68671980.js"><link rel="prefetch" href="/assets/js/226.a86d7e18.js"><link rel="prefetch" href="/assets/js/227.4f74e60d.js"><link rel="prefetch" href="/assets/js/228.69e3738c.js"><link rel="prefetch" href="/assets/js/229.cc86d20e.js"><link rel="prefetch" href="/assets/js/23.fb89e9d8.js"><link rel="prefetch" href="/assets/js/230.cecf4fd1.js"><link rel="prefetch" href="/assets/js/231.6d4140e7.js"><link rel="prefetch" href="/assets/js/232.557df262.js"><link rel="prefetch" href="/assets/js/233.a534d633.js"><link rel="prefetch" href="/assets/js/234.71c05b33.js"><link rel="prefetch" href="/assets/js/235.ba9a109c.js"><link rel="prefetch" href="/assets/js/236.2268c629.js"><link rel="prefetch" href="/assets/js/237.445a060f.js"><link rel="prefetch" href="/assets/js/238.c89aeff9.js"><link rel="prefetch" href="/assets/js/239.581c2181.js"><link rel="prefetch" href="/assets/js/24.8c13fac5.js"><link rel="prefetch" href="/assets/js/240.9e2f8875.js"><link rel="prefetch" href="/assets/js/241.2782e9ed.js"><link rel="prefetch" href="/assets/js/242.c06b9c04.js"><link rel="prefetch" href="/assets/js/243.4555b7a9.js"><link rel="prefetch" href="/assets/js/244.4ca0b62b.js"><link rel="prefetch" href="/assets/js/245.e2157b7c.js"><link rel="prefetch" href="/assets/js/246.e3fd6daa.js"><link rel="prefetch" href="/assets/js/247.2aa98fcb.js"><link rel="prefetch" href="/assets/js/248.0b007e3b.js"><link rel="prefetch" href="/assets/js/249.324afced.js"><link rel="prefetch" href="/assets/js/25.b32cadc2.js"><link rel="prefetch" href="/assets/js/250.8d0560e9.js"><link rel="prefetch" href="/assets/js/251.7b89d07f.js"><link rel="prefetch" href="/assets/js/252.8c569b7b.js"><link rel="prefetch" href="/assets/js/253.d4893421.js"><link rel="prefetch" href="/assets/js/254.d37b242a.js"><link rel="prefetch" href="/assets/js/255.e0fc5aa1.js"><link rel="prefetch" href="/assets/js/256.e73eaf0e.js"><link rel="prefetch" href="/assets/js/257.234387cc.js"><link rel="prefetch" href="/assets/js/258.c44a2fcb.js"><link rel="prefetch" href="/assets/js/259.ca308b57.js"><link rel="prefetch" href="/assets/js/26.a8b2cc1d.js"><link rel="prefetch" href="/assets/js/260.285ac534.js"><link rel="prefetch" href="/assets/js/261.8c67cf00.js"><link rel="prefetch" href="/assets/js/262.9457de7c.js"><link rel="prefetch" href="/assets/js/263.60228ee1.js"><link rel="prefetch" href="/assets/js/264.1338a92b.js"><link rel="prefetch" href="/assets/js/265.a356d789.js"><link rel="prefetch" href="/assets/js/266.9da390d9.js"><link rel="prefetch" href="/assets/js/267.03efbf98.js"><link rel="prefetch" href="/assets/js/268.7554bb79.js"><link rel="prefetch" href="/assets/js/269.7f9a0b36.js"><link rel="prefetch" href="/assets/js/27.58a5153a.js"><link rel="prefetch" href="/assets/js/270.1dd93a33.js"><link rel="prefetch" href="/assets/js/271.2f5d530e.js"><link rel="prefetch" href="/assets/js/272.0898a56f.js"><link rel="prefetch" href="/assets/js/273.54efcd80.js"><link rel="prefetch" href="/assets/js/274.55fb26b4.js"><link rel="prefetch" href="/assets/js/275.a69204ae.js"><link rel="prefetch" href="/assets/js/276.d5502f01.js"><link rel="prefetch" href="/assets/js/277.ad72dea1.js"><link rel="prefetch" href="/assets/js/278.ff0b5bbd.js"><link rel="prefetch" href="/assets/js/279.c3e712fa.js"><link rel="prefetch" href="/assets/js/28.3749c0f0.js"><link rel="prefetch" href="/assets/js/280.711acfba.js"><link rel="prefetch" href="/assets/js/281.c95b3340.js"><link rel="prefetch" href="/assets/js/282.ac7e8691.js"><link rel="prefetch" href="/assets/js/283.fabef513.js"><link rel="prefetch" href="/assets/js/284.86f73852.js"><link rel="prefetch" href="/assets/js/285.99c2096e.js"><link rel="prefetch" href="/assets/js/286.ea50cc8f.js"><link rel="prefetch" href="/assets/js/287.f15c00ac.js"><link rel="prefetch" href="/assets/js/288.7cf537e3.js"><link rel="prefetch" href="/assets/js/289.fe243ae2.js"><link rel="prefetch" href="/assets/js/29.83a6f23d.js"><link rel="prefetch" href="/assets/js/290.e67bb4df.js"><link rel="prefetch" href="/assets/js/291.6651d477.js"><link rel="prefetch" href="/assets/js/292.69a33b1e.js"><link rel="prefetch" href="/assets/js/293.8d6446cc.js"><link rel="prefetch" href="/assets/js/294.9a1ee4c6.js"><link rel="prefetch" href="/assets/js/295.c14904ff.js"><link rel="prefetch" href="/assets/js/296.02057891.js"><link rel="prefetch" href="/assets/js/297.3b3cac57.js"><link rel="prefetch" href="/assets/js/298.3b35a038.js"><link rel="prefetch" href="/assets/js/299.28fa1ec6.js"><link rel="prefetch" href="/assets/js/3.d363f7a0.js"><link rel="prefetch" href="/assets/js/30.2a0c0fca.js"><link rel="prefetch" href="/assets/js/300.416bf990.js"><link rel="prefetch" href="/assets/js/301.d6a6916d.js"><link rel="prefetch" href="/assets/js/302.a3eee46b.js"><link rel="prefetch" href="/assets/js/303.6d024f9e.js"><link rel="prefetch" href="/assets/js/304.fdaffc49.js"><link rel="prefetch" href="/assets/js/305.5b40d860.js"><link rel="prefetch" href="/assets/js/306.3cc9402a.js"><link rel="prefetch" href="/assets/js/307.e2acd89a.js"><link rel="prefetch" href="/assets/js/308.75930cd5.js"><link rel="prefetch" href="/assets/js/309.e3f5a4b6.js"><link rel="prefetch" href="/assets/js/31.070098ba.js"><link rel="prefetch" href="/assets/js/310.5afe1c3c.js"><link rel="prefetch" href="/assets/js/311.313b5a16.js"><link rel="prefetch" href="/assets/js/312.0b8226f2.js"><link rel="prefetch" href="/assets/js/313.60539d18.js"><link rel="prefetch" href="/assets/js/314.1d925fa8.js"><link rel="prefetch" href="/assets/js/315.464b4691.js"><link rel="prefetch" href="/assets/js/316.24fa733c.js"><link rel="prefetch" href="/assets/js/317.ad0976ef.js"><link rel="prefetch" href="/assets/js/318.c3f736aa.js"><link rel="prefetch" href="/assets/js/319.781775f1.js"><link rel="prefetch" href="/assets/js/32.b7e22bde.js"><link rel="prefetch" href="/assets/js/320.b599ccf7.js"><link rel="prefetch" href="/assets/js/321.e23cbab2.js"><link rel="prefetch" href="/assets/js/322.c84869c8.js"><link rel="prefetch" href="/assets/js/323.53eb02fc.js"><link rel="prefetch" href="/assets/js/324.e48d0729.js"><link rel="prefetch" href="/assets/js/325.57f4c93d.js"><link rel="prefetch" href="/assets/js/326.a19f11f7.js"><link rel="prefetch" href="/assets/js/327.a5cac4bf.js"><link rel="prefetch" href="/assets/js/328.72b842c3.js"><link rel="prefetch" href="/assets/js/329.439f04cd.js"><link rel="prefetch" href="/assets/js/33.13e7fa62.js"><link rel="prefetch" href="/assets/js/330.b2368b89.js"><link rel="prefetch" href="/assets/js/331.1a54c44d.js"><link rel="prefetch" href="/assets/js/332.e5cfa3af.js"><link rel="prefetch" href="/assets/js/333.97f6734c.js"><link rel="prefetch" href="/assets/js/334.817809b8.js"><link rel="prefetch" href="/assets/js/335.41d696fa.js"><link rel="prefetch" href="/assets/js/336.6d88b12b.js"><link rel="prefetch" href="/assets/js/337.8a877830.js"><link rel="prefetch" href="/assets/js/338.b1629db0.js"><link rel="prefetch" href="/assets/js/339.28595515.js"><link rel="prefetch" href="/assets/js/34.de3fb91b.js"><link rel="prefetch" href="/assets/js/340.f0520f1b.js"><link rel="prefetch" href="/assets/js/341.9170a7b4.js"><link rel="prefetch" href="/assets/js/342.826a2395.js"><link rel="prefetch" href="/assets/js/343.c5bbb22e.js"><link rel="prefetch" href="/assets/js/344.39437b7e.js"><link rel="prefetch" href="/assets/js/345.4ac85cb1.js"><link rel="prefetch" href="/assets/js/346.b7cac995.js"><link rel="prefetch" href="/assets/js/347.3b181b3e.js"><link rel="prefetch" href="/assets/js/348.7afab242.js"><link rel="prefetch" href="/assets/js/349.d5b1b493.js"><link rel="prefetch" href="/assets/js/35.bbceee9a.js"><link rel="prefetch" href="/assets/js/350.43faccab.js"><link rel="prefetch" href="/assets/js/351.2e503ac6.js"><link rel="prefetch" href="/assets/js/352.b4ea61d2.js"><link rel="prefetch" href="/assets/js/353.46be9fe7.js"><link rel="prefetch" href="/assets/js/354.7ecda5f2.js"><link rel="prefetch" href="/assets/js/355.ba585b66.js"><link rel="prefetch" href="/assets/js/356.1156e5ed.js"><link rel="prefetch" href="/assets/js/357.4631a1a5.js"><link rel="prefetch" href="/assets/js/358.d1712b45.js"><link rel="prefetch" href="/assets/js/359.bc68b3f3.js"><link rel="prefetch" href="/assets/js/36.95bde027.js"><link rel="prefetch" href="/assets/js/360.53733ecc.js"><link rel="prefetch" href="/assets/js/361.560d31f7.js"><link rel="prefetch" href="/assets/js/362.ae683f5c.js"><link rel="prefetch" href="/assets/js/363.c539d235.js"><link rel="prefetch" href="/assets/js/364.59e2b91b.js"><link rel="prefetch" href="/assets/js/365.400a6704.js"><link rel="prefetch" href="/assets/js/366.56543e5d.js"><link rel="prefetch" href="/assets/js/367.61457c03.js"><link rel="prefetch" href="/assets/js/368.43e030b0.js"><link rel="prefetch" href="/assets/js/369.d136627b.js"><link rel="prefetch" href="/assets/js/37.24fd0dc4.js"><link rel="prefetch" href="/assets/js/370.6fabf865.js"><link rel="prefetch" href="/assets/js/371.259e6966.js"><link rel="prefetch" href="/assets/js/372.c2068a2e.js"><link rel="prefetch" href="/assets/js/373.aa966bbd.js"><link rel="prefetch" href="/assets/js/374.fcf4ea77.js"><link rel="prefetch" href="/assets/js/375.3a25c41d.js"><link rel="prefetch" href="/assets/js/376.99f5186d.js"><link rel="prefetch" href="/assets/js/377.31380a56.js"><link rel="prefetch" href="/assets/js/378.49ec86ad.js"><link rel="prefetch" href="/assets/js/379.3d4f78b1.js"><link rel="prefetch" href="/assets/js/38.15ea1a26.js"><link rel="prefetch" href="/assets/js/380.d6a9def6.js"><link rel="prefetch" href="/assets/js/381.8ea7624d.js"><link rel="prefetch" href="/assets/js/382.dbbe4921.js"><link rel="prefetch" href="/assets/js/383.e9b99b21.js"><link rel="prefetch" href="/assets/js/384.9adcb98e.js"><link rel="prefetch" href="/assets/js/385.450940b2.js"><link rel="prefetch" href="/assets/js/386.cb6f3e50.js"><link rel="prefetch" href="/assets/js/387.0249780a.js"><link rel="prefetch" href="/assets/js/388.3bf13998.js"><link rel="prefetch" href="/assets/js/389.37774770.js"><link rel="prefetch" href="/assets/js/39.13290961.js"><link rel="prefetch" href="/assets/js/390.08ae0c08.js"><link rel="prefetch" href="/assets/js/391.930cae72.js"><link rel="prefetch" href="/assets/js/392.62e65c42.js"><link rel="prefetch" href="/assets/js/393.e372beb8.js"><link rel="prefetch" href="/assets/js/394.eb79c795.js"><link rel="prefetch" href="/assets/js/395.be00503d.js"><link rel="prefetch" href="/assets/js/396.64b175cb.js"><link rel="prefetch" href="/assets/js/397.5be7f8f2.js"><link rel="prefetch" href="/assets/js/398.0b8fac6e.js"><link rel="prefetch" href="/assets/js/399.a28d13f6.js"><link rel="prefetch" href="/assets/js/4.3088af78.js"><link rel="prefetch" href="/assets/js/40.38a0f047.js"><link rel="prefetch" href="/assets/js/400.3d742b56.js"><link rel="prefetch" href="/assets/js/401.b6fa4b70.js"><link rel="prefetch" href="/assets/js/402.710f3aff.js"><link rel="prefetch" href="/assets/js/403.f180d4ef.js"><link rel="prefetch" href="/assets/js/404.b4a2b6a4.js"><link rel="prefetch" href="/assets/js/405.98065449.js"><link rel="prefetch" href="/assets/js/406.714ad041.js"><link rel="prefetch" href="/assets/js/407.2772c1cb.js"><link rel="prefetch" href="/assets/js/408.cd7003d0.js"><link rel="prefetch" href="/assets/js/409.5769a3b2.js"><link rel="prefetch" href="/assets/js/41.3794ea77.js"><link rel="prefetch" href="/assets/js/410.b488a9eb.js"><link rel="prefetch" href="/assets/js/411.0f47e7ba.js"><link rel="prefetch" href="/assets/js/412.733482d3.js"><link rel="prefetch" href="/assets/js/413.303ed27a.js"><link rel="prefetch" href="/assets/js/414.5edae491.js"><link rel="prefetch" href="/assets/js/415.b02b3ceb.js"><link rel="prefetch" href="/assets/js/416.33aff0dc.js"><link rel="prefetch" href="/assets/js/417.c6450ed3.js"><link rel="prefetch" href="/assets/js/418.c1d2f7a8.js"><link rel="prefetch" href="/assets/js/419.781f17ef.js"><link rel="prefetch" href="/assets/js/42.b81a66f1.js"><link rel="prefetch" href="/assets/js/420.7cdfc1cb.js"><link rel="prefetch" href="/assets/js/421.05cdb910.js"><link rel="prefetch" href="/assets/js/422.7e0a515f.js"><link rel="prefetch" href="/assets/js/423.1b641ba5.js"><link rel="prefetch" href="/assets/js/424.a57bbcf2.js"><link rel="prefetch" href="/assets/js/425.92d79100.js"><link rel="prefetch" href="/assets/js/426.3259ff50.js"><link rel="prefetch" href="/assets/js/427.e252f42c.js"><link rel="prefetch" href="/assets/js/428.2a5d1cee.js"><link rel="prefetch" href="/assets/js/429.facceddc.js"><link rel="prefetch" href="/assets/js/43.d4eb4794.js"><link rel="prefetch" href="/assets/js/430.aa89fac7.js"><link rel="prefetch" href="/assets/js/431.064784f9.js"><link rel="prefetch" href="/assets/js/432.672f4123.js"><link rel="prefetch" href="/assets/js/433.607d57c0.js"><link rel="prefetch" href="/assets/js/434.7f192f69.js"><link rel="prefetch" href="/assets/js/435.2bf3bc33.js"><link rel="prefetch" href="/assets/js/436.25597889.js"><link rel="prefetch" href="/assets/js/437.fb8efad6.js"><link rel="prefetch" href="/assets/js/438.8619b669.js"><link rel="prefetch" href="/assets/js/439.2101c43d.js"><link rel="prefetch" href="/assets/js/44.33a5f01c.js"><link rel="prefetch" href="/assets/js/440.7a953668.js"><link rel="prefetch" href="/assets/js/441.35a50993.js"><link rel="prefetch" href="/assets/js/442.66750513.js"><link rel="prefetch" href="/assets/js/443.4beb7df3.js"><link rel="prefetch" href="/assets/js/444.9be4a5b9.js"><link rel="prefetch" href="/assets/js/445.43b337d0.js"><link rel="prefetch" href="/assets/js/446.ce564359.js"><link rel="prefetch" href="/assets/js/447.284a794f.js"><link rel="prefetch" href="/assets/js/448.601a1d84.js"><link rel="prefetch" href="/assets/js/449.6c020979.js"><link rel="prefetch" href="/assets/js/45.20dc10fd.js"><link rel="prefetch" href="/assets/js/450.16990cc4.js"><link rel="prefetch" href="/assets/js/451.dacdc330.js"><link rel="prefetch" href="/assets/js/452.97164781.js"><link rel="prefetch" href="/assets/js/453.90d7f78b.js"><link rel="prefetch" href="/assets/js/454.4eb1d94c.js"><link rel="prefetch" href="/assets/js/455.d407cbb9.js"><link rel="prefetch" href="/assets/js/456.24b17a87.js"><link rel="prefetch" href="/assets/js/457.3a1dc217.js"><link rel="prefetch" href="/assets/js/458.ec74db40.js"><link rel="prefetch" href="/assets/js/459.fdfbe725.js"><link rel="prefetch" href="/assets/js/46.ab887211.js"><link rel="prefetch" href="/assets/js/460.dff84093.js"><link rel="prefetch" href="/assets/js/461.47ed06bb.js"><link rel="prefetch" href="/assets/js/462.4554399a.js"><link rel="prefetch" href="/assets/js/463.cfdf9a17.js"><link rel="prefetch" href="/assets/js/464.c367274b.js"><link rel="prefetch" href="/assets/js/465.5ea1c44e.js"><link rel="prefetch" href="/assets/js/466.9f7b3846.js"><link rel="prefetch" href="/assets/js/467.0a318f4c.js"><link rel="prefetch" href="/assets/js/468.253dad00.js"><link rel="prefetch" href="/assets/js/469.5fd4aac7.js"><link rel="prefetch" href="/assets/js/47.161ec1b1.js"><link rel="prefetch" href="/assets/js/470.aea20eb0.js"><link rel="prefetch" href="/assets/js/471.82b42d86.js"><link rel="prefetch" href="/assets/js/472.00129a86.js"><link rel="prefetch" href="/assets/js/473.bcac4660.js"><link rel="prefetch" href="/assets/js/474.22d1df13.js"><link rel="prefetch" href="/assets/js/475.87076e0f.js"><link rel="prefetch" href="/assets/js/476.e7016bb8.js"><link rel="prefetch" href="/assets/js/477.1fb1bd33.js"><link rel="prefetch" href="/assets/js/478.9ad255ee.js"><link rel="prefetch" href="/assets/js/479.d067d219.js"><link rel="prefetch" href="/assets/js/48.5ec2bc97.js"><link rel="prefetch" href="/assets/js/480.a75c7328.js"><link rel="prefetch" href="/assets/js/481.471c13d7.js"><link rel="prefetch" href="/assets/js/482.b79afbd0.js"><link rel="prefetch" href="/assets/js/483.ff9497cf.js"><link rel="prefetch" href="/assets/js/484.40b8d4b5.js"><link rel="prefetch" href="/assets/js/485.da85d7bc.js"><link rel="prefetch" href="/assets/js/486.58c25c2c.js"><link rel="prefetch" href="/assets/js/487.c802b993.js"><link rel="prefetch" href="/assets/js/49.c47b83cb.js"><link rel="prefetch" href="/assets/js/5.464d5f32.js"><link rel="prefetch" href="/assets/js/50.6527351d.js"><link rel="prefetch" href="/assets/js/51.61dd061a.js"><link rel="prefetch" href="/assets/js/52.a3442d36.js"><link rel="prefetch" href="/assets/js/53.550a6017.js"><link rel="prefetch" href="/assets/js/54.76beb39e.js"><link rel="prefetch" href="/assets/js/55.b7948a78.js"><link rel="prefetch" href="/assets/js/56.e55aadf9.js"><link rel="prefetch" href="/assets/js/57.66b632c1.js"><link rel="prefetch" href="/assets/js/58.bd8a42ec.js"><link rel="prefetch" href="/assets/js/59.ca6dc059.js"><link rel="prefetch" href="/assets/js/6.0ceb5c68.js"><link rel="prefetch" href="/assets/js/60.4f696a43.js"><link rel="prefetch" href="/assets/js/61.e03d9700.js"><link rel="prefetch" href="/assets/js/62.2e3e5eeb.js"><link rel="prefetch" href="/assets/js/63.955f4175.js"><link rel="prefetch" href="/assets/js/64.7ad7cb99.js"><link rel="prefetch" href="/assets/js/65.3131c091.js"><link rel="prefetch" href="/assets/js/66.6d5d2799.js"><link rel="prefetch" href="/assets/js/67.27324a23.js"><link rel="prefetch" href="/assets/js/68.b986c565.js"><link rel="prefetch" href="/assets/js/69.80dd843f.js"><link rel="prefetch" href="/assets/js/7.3adc1d3f.js"><link rel="prefetch" href="/assets/js/70.9c7ec326.js"><link rel="prefetch" href="/assets/js/71.411ff021.js"><link rel="prefetch" href="/assets/js/72.35b66e8f.js"><link rel="prefetch" href="/assets/js/73.e7b695c0.js"><link rel="prefetch" href="/assets/js/74.30af475a.js"><link rel="prefetch" href="/assets/js/75.dad67a04.js"><link rel="prefetch" href="/assets/js/76.b5642785.js"><link rel="prefetch" href="/assets/js/77.1b3a424e.js"><link rel="prefetch" href="/assets/js/78.db822987.js"><link rel="prefetch" href="/assets/js/79.09a13430.js"><link rel="prefetch" href="/assets/js/8.80d0563a.js"><link rel="prefetch" href="/assets/js/80.8158198c.js"><link rel="prefetch" href="/assets/js/81.b87d6c57.js"><link rel="prefetch" href="/assets/js/82.bfe4e390.js"><link rel="prefetch" href="/assets/js/83.3cc46ac1.js"><link rel="prefetch" href="/assets/js/84.aab500df.js"><link rel="prefetch" href="/assets/js/85.484f1869.js"><link rel="prefetch" href="/assets/js/86.da7ae4ff.js"><link rel="prefetch" href="/assets/js/87.300ac6c3.js"><link rel="prefetch" href="/assets/js/88.9de316df.js"><link rel="prefetch" href="/assets/js/89.cbb0f7d9.js"><link rel="prefetch" href="/assets/js/9.902c1830.js"><link rel="prefetch" href="/assets/js/90.96ae648f.js"><link rel="prefetch" href="/assets/js/91.409de486.js"><link rel="prefetch" href="/assets/js/92.6de09e33.js"><link rel="prefetch" href="/assets/js/93.5ec848ed.js"><link rel="prefetch" href="/assets/js/94.f3fc630d.js"><link rel="prefetch" href="/assets/js/95.395abbd4.js"><link rel="prefetch" href="/assets/js/96.be9a8b79.js"><link rel="prefetch" href="/assets/js/97.7df4cc5b.js"><link rel="prefetch" href="/assets/js/98.4c3e583d.js"><link rel="prefetch" href="/assets/js/99.f452b1ba.js">
    <link rel="stylesheet" href="/assets/css/0.styles.008dd71f.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="yyz notes" class="logo"> <span class="site-name can-hide">yyz notes</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="系统功能设计" class="dropdown-title"><a href="/systems/" class="link-title">系统功能设计</a> <span class="title" style="display:none;">系统功能设计</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/dfadd6/" class="nav-link">RBAC权限设计</a></li><li class="dropdown-item"><!----> <a href="/pages/43bca1/" class="nav-link">架构图标设计</a></li><li class="dropdown-item"><!----> <a href="/pages/1d4369/" class="nav-link">账号体系</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="python" class="dropdown-title"><a href="/python/" class="link-title">python</a> <span class="title" style="display:none;">python</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/218041/" class="nav-link">python基础</a></li><li class="dropdown-item"><!----> <a href="/pages/5b5296/" class="nav-link">python高级</a></li><li class="dropdown-item"><!----> <a href="/pages/265f6b/" class="nav-link">python模块</a></li><li class="dropdown-item"><!----> <a href="/pages/a544d5/" class="nav-link">python设计模式</a></li><li class="dropdown-item"><!----> <a href="/pages/fae1d5/" class="nav-link">python数据结构与算法</a></li><li class="dropdown-item"><!----> <a href="/pages/729c08/" class="nav-link">django</a></li><li class="dropdown-item"><!----> <a href="/pages/1f1185/" class="nav-link">django-DRF</a></li><li class="dropdown-item"><!----> <a href="/pages/6400c2/" class="nav-link">flask</a></li><li class="dropdown-item"><!----> <a href="/pages/3a3e9f/" class="nav-link">直接设计开源pip包</a></li><li class="dropdown-item"><!----> <a href="/pages/39e704/" class="nav-link">直接设计开源项目</a></li><li class="dropdown-item"><!----> <a href="/pages/d4123d/" class="nav-link">python示例题/脚本</a></li><li class="dropdown-item"><!----> <a href="/pages/934fa5/" class="nav-link">python面试题</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="golang" class="dropdown-title"><a href="/golang/" class="link-title">golang</a> <span class="title" style="display:none;">golang</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/9a36e1/" class="nav-link">golang基础</a></li><li class="dropdown-item"><!----> <a href="/pages/bc37bd/" class="nav-link">golang高级</a></li><li class="dropdown-item"><!----> <a href="/pages/fdbbda/" class="nav-link">golang常用组件</a></li><li class="dropdown-item"><!----> <a href="/pages/c60067/" class="nav-link">gin框架</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/front/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/b55ef2/" class="nav-link">es6</a></li><li class="dropdown-item"><!----> <a href="/pages/490340/" class="nav-link">javascript</a></li><li class="dropdown-item"><!----> <a href="/pages/be3741/" class="nav-link">react</a></li><li class="dropdown-item"><!----> <a href="/pages/e0f7a6/" class="nav-link">vue</a></li><li class="dropdown-item"><!----> <a href="/pages/183a5e/" class="nav-link">TypeScript</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据存储" class="dropdown-title"><a href="/datas/" class="link-title">数据存储</a> <span class="title" style="display:none;">数据存储</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/14835d/" class="nav-link">mysql</a></li><li class="dropdown-item"><!----> <a href="/pages/d47a6a/" class="nav-link">redis</a></li><li class="dropdown-item"><!----> <a href="/pages/4d3a23/" class="nav-link">minio</a></li><li class="dropdown-item"><!----> <a href="/pages/b66577/" class="nav-link">elasticsearch</a></li><li class="dropdown-item"><!----> <a href="/pages/687094/" class="nav-link">mongodb</a></li><li class="dropdown-item"><!----> <a href="/pages/16380c/" class="nav-link">消息队列</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="测试" class="dropdown-title"><a href="/tests/" class="link-title">测试</a> <span class="title" style="display:none;">测试</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/dfadd6/" class="nav-link">自动化测试</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="运维部署" class="dropdown-title"><a href="/deployments/" class="link-title">运维部署</a> <span class="title" style="display:none;">运维部署</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>操作系统</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/d5b367/" class="nav-link">linux</a></li><li class="dropdown-subitem"><a href="/pages/dcbaac/" class="nav-link">windows</a></li></ul></li><li class="dropdown-item"><!----> <a href="/pages/25bfa3/" class="nav-link">nginx</a></li><li class="dropdown-item"><!----> <a href="/pages/71bb52/" class="nav-link">docker</a></li><li class="dropdown-item"><!----> <a href="/pages/829e67/" class="nav-link">k8s</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具" class="dropdown-title"><a href="/tools/" class="link-title">工具</a> <span class="title" style="display:none;">工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/4dd1e5/" class="nav-link">git</a></li><li class="dropdown-item"><!----> <a href="/pages/4dd1e5/" class="nav-link">ldap</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/mores/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/f2a556/" class="nav-link">学习</a></li><li class="dropdown-item"><!----> <a href="/pages/aea6571b7a8bae86/" class="nav-link">面试</a></li><li class="dropdown-item"><!----> <a href="/pages/2d615df9a36a98ed/" class="nav-link">心情杂货</a></li><li class="dropdown-item"><!----> <a href="/pages/baaa02/" class="nav-link">实用技巧</a></li><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/pages/beb6c0bd8a66cea6/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/YiZhang-You" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/img/logo.png"> <div class="blogger-info"><h3>益章</h3> <span>可乐鸡翅</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="系统功能设计" class="dropdown-title"><a href="/systems/" class="link-title">系统功能设计</a> <span class="title" style="display:none;">系统功能设计</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/dfadd6/" class="nav-link">RBAC权限设计</a></li><li class="dropdown-item"><!----> <a href="/pages/43bca1/" class="nav-link">架构图标设计</a></li><li class="dropdown-item"><!----> <a href="/pages/1d4369/" class="nav-link">账号体系</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="python" class="dropdown-title"><a href="/python/" class="link-title">python</a> <span class="title" style="display:none;">python</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/218041/" class="nav-link">python基础</a></li><li class="dropdown-item"><!----> <a href="/pages/5b5296/" class="nav-link">python高级</a></li><li class="dropdown-item"><!----> <a href="/pages/265f6b/" class="nav-link">python模块</a></li><li class="dropdown-item"><!----> <a href="/pages/a544d5/" class="nav-link">python设计模式</a></li><li class="dropdown-item"><!----> <a href="/pages/fae1d5/" class="nav-link">python数据结构与算法</a></li><li class="dropdown-item"><!----> <a href="/pages/729c08/" class="nav-link">django</a></li><li class="dropdown-item"><!----> <a href="/pages/1f1185/" class="nav-link">django-DRF</a></li><li class="dropdown-item"><!----> <a href="/pages/6400c2/" class="nav-link">flask</a></li><li class="dropdown-item"><!----> <a href="/pages/3a3e9f/" class="nav-link">直接设计开源pip包</a></li><li class="dropdown-item"><!----> <a href="/pages/39e704/" class="nav-link">直接设计开源项目</a></li><li class="dropdown-item"><!----> <a href="/pages/d4123d/" class="nav-link">python示例题/脚本</a></li><li class="dropdown-item"><!----> <a href="/pages/934fa5/" class="nav-link">python面试题</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="golang" class="dropdown-title"><a href="/golang/" class="link-title">golang</a> <span class="title" style="display:none;">golang</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/9a36e1/" class="nav-link">golang基础</a></li><li class="dropdown-item"><!----> <a href="/pages/bc37bd/" class="nav-link">golang高级</a></li><li class="dropdown-item"><!----> <a href="/pages/fdbbda/" class="nav-link">golang常用组件</a></li><li class="dropdown-item"><!----> <a href="/pages/c60067/" class="nav-link">gin框架</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/front/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/b55ef2/" class="nav-link">es6</a></li><li class="dropdown-item"><!----> <a href="/pages/490340/" class="nav-link">javascript</a></li><li class="dropdown-item"><!----> <a href="/pages/be3741/" class="nav-link">react</a></li><li class="dropdown-item"><!----> <a href="/pages/e0f7a6/" class="nav-link">vue</a></li><li class="dropdown-item"><!----> <a href="/pages/183a5e/" class="nav-link">TypeScript</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据存储" class="dropdown-title"><a href="/datas/" class="link-title">数据存储</a> <span class="title" style="display:none;">数据存储</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/14835d/" class="nav-link">mysql</a></li><li class="dropdown-item"><!----> <a href="/pages/d47a6a/" class="nav-link">redis</a></li><li class="dropdown-item"><!----> <a href="/pages/4d3a23/" class="nav-link">minio</a></li><li class="dropdown-item"><!----> <a href="/pages/b66577/" class="nav-link">elasticsearch</a></li><li class="dropdown-item"><!----> <a href="/pages/687094/" class="nav-link">mongodb</a></li><li class="dropdown-item"><!----> <a href="/pages/16380c/" class="nav-link">消息队列</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="测试" class="dropdown-title"><a href="/tests/" class="link-title">测试</a> <span class="title" style="display:none;">测试</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/dfadd6/" class="nav-link">自动化测试</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="运维部署" class="dropdown-title"><a href="/deployments/" class="link-title">运维部署</a> <span class="title" style="display:none;">运维部署</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>操作系统</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/d5b367/" class="nav-link">linux</a></li><li class="dropdown-subitem"><a href="/pages/dcbaac/" class="nav-link">windows</a></li></ul></li><li class="dropdown-item"><!----> <a href="/pages/25bfa3/" class="nav-link">nginx</a></li><li class="dropdown-item"><!----> <a href="/pages/71bb52/" class="nav-link">docker</a></li><li class="dropdown-item"><!----> <a href="/pages/829e67/" class="nav-link">k8s</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具" class="dropdown-title"><a href="/tools/" class="link-title">工具</a> <span class="title" style="display:none;">工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/4dd1e5/" class="nav-link">git</a></li><li class="dropdown-item"><!----> <a href="/pages/4dd1e5/" class="nav-link">ldap</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/mores/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/f2a556/" class="nav-link">学习</a></li><li class="dropdown-item"><!----> <a href="/pages/aea6571b7a8bae86/" class="nav-link">面试</a></li><li class="dropdown-item"><!----> <a href="/pages/2d615df9a36a98ed/" class="nav-link">心情杂货</a></li><li class="dropdown-item"><!----> <a href="/pages/baaa02/" class="nav-link">实用技巧</a></li><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/pages/beb6c0bd8a66cea6/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/YiZhang-You" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>python基础</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>python概述</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>python环境搭建</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>python基础语法</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>python关键字与标识符</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>python流程控制</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>python函数</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>python内置函数</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>python面向对象</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/7df239/" class="sidebar-link">面向对象、面向过程</a></li><li><a href="/pages/ccbc9e/" class="sidebar-link">面向对象中的属性</a></li><li><a href="/pages/99af15/" class="sidebar-link">面向对象中的方法</a></li><li><a href="/pages/f8ff0d/" class="sidebar-link">封装（三大特性）</a></li><li><a href="/pages/08bb5a/" class="sidebar-link">继承（三大特性）</a></li><li><a href="/pages/b83861/" class="sidebar-link">多态（三大特性）</a></li><li><a href="/pages/db9580/" class="sidebar-link">反射</a></li><li><a href="/pages/8b212a/" class="sidebar-link">python中的下划线</a></li><li><a href="/pages/ddb850/" class="sidebar-link">python中的super()</a></li><li><a href="/pages/f437c1/" aria-current="page" class="active sidebar-link">python魔法方法</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/f437c1/#python魔法方法" class="sidebar-link">python魔法方法</a></li><li class="sidebar-sub-header level2"><a href="/pages/f437c1/#简介" class="sidebar-link">简介</a></li><li class="sidebar-sub-header level2"><a href="/pages/f437c1/#链接资料" class="sidebar-link">链接资料</a></li><li class="sidebar-sub-header level2"><a href="/pages/f437c1/#_1-什么是魔法方法" class="sidebar-link">1. *什么是魔法方法*</a></li><li class="sidebar-sub-header level2"><a href="/pages/f437c1/#_2-1-构造与初始化" class="sidebar-link">2.1 构造与初始化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/f437c1/#init" class="sidebar-link">**__init__**</a></li><li class="sidebar-sub-header level3"><a href="/pages/f437c1/#new" class="sidebar-link">__new__</a></li><li class="sidebar-sub-header level3"><a href="/pages/f437c1/#del" class="sidebar-link">__del__</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/f437c1/#_2-2-控制属性访问" class="sidebar-link">*2.2 控制属性访问*</a></li><li class="sidebar-sub-header level2"><a href="/pages/f437c1/#_2-3-容器类操作" class="sidebar-link">*2.3 容器类操作*</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/f437c1/#len" class="sidebar-link">__len__</a></li><li class="sidebar-sub-header level3"><a href="/pages/f437c1/#getitem-、-setitem-、-delitem" class="sidebar-link">__getitem__、__setitem__、__delitem__</a></li><li class="sidebar-sub-header level3"><a href="/pages/f437c1/#iter" class="sidebar-link">__iter__</a></li><li class="sidebar-sub-header level3"><a href="/pages/f437c1/#reversed" class="sidebar-link">__reversed__</a></li><li class="sidebar-sub-header level3"><a href="/pages/f437c1/#contains" class="sidebar-link">__contains__</a></li><li class="sidebar-sub-header level3"><a href="/pages/f437c1/#面试题-自定义容器" class="sidebar-link">面试题：自定义容器</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/f437c1/#_2-4-类的表示" class="sidebar-link">*2.4 类的表示*</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/f437c1/#str-、-repr" class="sidebar-link">__str__、__repr__</a></li><li class="sidebar-sub-header level3"><a href="/pages/f437c1/#bool" class="sidebar-link">__bool__</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/f437c1/#_2-5-可调用对象" class="sidebar-link">*2.5 可调用对象*</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/f437c1/#call" class="sidebar-link">__call__</a></li><li class="sidebar-sub-header level3"><a href="/pages/f437c1/#call子类的改写其他方法-在不改变原代码的情况下取得不同的结果" class="sidebar-link">call子类的改写其他方法，在不改变原代码的情况下取得不同的结果</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/f437c1/#_2-6-序列化" class="sidebar-link">*2.6 序列化*</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/f437c1/#getstate-、-setstate" class="sidebar-link">__getstate__、__setstate__</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/f437c1/#_2-7-反射" class="sidebar-link">*2.7 反射*</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/f437c1/#instancecheck-、-subclasscheck" class="sidebar-link">__instancecheck__、__subclasscheck__</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/f437c1/#_2-8-比较、运算、类型等操作" class="sidebar-link">*2.8 比较、运算、类型等操作*</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/f437c1/#eq" class="sidebar-link">__eq__</a></li><li class="sidebar-sub-header level3"><a href="/pages/f437c1/#int" class="sidebar-link">__int__</a></li><li class="sidebar-sub-header level3"><a href="/pages/f437c1/#总结" class="sidebar-link">总结</a></li></ul></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>python模块与包</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>python文件IO与OS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>python异常处理机制</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>python高级</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>python模块</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>python设计模式</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>python数据结构与算法</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>django</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>django-DRF</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>flask</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>自己设计开源pip包</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>自己设计开源项目</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>python小示例</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>python面试题</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/python/#python" data-v-06225672>python</a></li><li data-v-06225672><a href="/python/#python基础" data-v-06225672>python基础</a></li><li data-v-06225672><a href="/python/#python面向对象" data-v-06225672>python面向对象</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/YiZhang-You" target="_blank" title="作者" class="beLink" data-v-06225672>YiZhang-You</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2023-05-10</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">python魔法方法<!----></h1> <!----> <div class="theme-vdoing-content content__default"><h2 id="python魔法方法"><a href="#python魔法方法" class="header-anchor">#</a> python魔法方法</h2> <h2 id="简介"><a href="#简介" class="header-anchor">#</a> 简介</h2> <p>魔法方式（Magic methods）是python的内置函数，一般以双下划线开头和结尾。</p> <h2 id="链接资料"><a href="#链接资料" class="header-anchor">#</a> 链接资料</h2> <ol><li><p>segmentfault</p> <p><a href="https://segmentfault.com/a/1190000040286979" target="_blank" rel="noopener noreferrer">python魔法方法长文详解<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li></ol> <h2 id="_1-什么是魔法方法"><a href="#_1-什么是魔法方法" class="header-anchor">#</a> 1. <strong><strong>什么是魔法方法</strong></strong></h2> <p>魔法方式（Magic methods）是python的内置函数，一般以双下划线开头和结尾，比如__add__,__new__等。每个魔法方法都有对应的一个内置函数或者运算符。当我们对象使用这些方法时，相当于对这个对象的这类方法进行重写（如运算符重载）。魔法方法的存在是对类或函数进行了提炼，供python解释器直接调用。当使用<code>len(obj)</code>时，实际上调用的就是<code>obj.__len__</code>方法,其它同理。</p> <p>dir()可以查看对象的所有方法和属性，其中双下划线开头和结尾的就是该对象具有的魔法方法。以整数对象为例：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span><span class="token builtin">dir</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token string">'__abs__'</span><span class="token punctuation">,</span> <span class="token string">'__add__'</span><span class="token punctuation">,</span> <span class="token string">'__and__'</span><span class="token punctuation">,</span> <span class="token string">'__bool__'</span><span class="token punctuation">,</span> <span class="token string">'__ceil__'</span><span class="token punctuation">,</span> <span class="token string">'__class__'</span><span class="token punctuation">,</span> <span class="token string">'__delattr__'</span><span class="token punctuation">,</span> <span class="token string">'__dir__'</span><span class="token punctuation">,</span> <span class="token string">'__divmod__'</span><span class="token punctuation">,</span> <span class="token string">'__doc__'</span><span class="token punctuation">,</span> <span class="token string">'__eq__'</span><span class="token punctuation">,</span> <span class="token string">'__float__'</span><span class="token punctuation">,</span> <span class="token string">'__floor__'</span><span class="token punctuation">,</span> <span class="token string">'__floordiv__'</span><span class="token punctuation">,</span> <span class="token string">'__format__'</span><span class="token punctuation">,</span> <span class="token string">'__ge__'</span><span class="token punctuation">,</span> <span class="token string">'__getattribute__'</span><span class="token punctuation">,</span> <span class="token string">'__getnewargs__'</span><span class="token punctuation">,</span> <span class="token string">'__gt__'</span><span class="token punctuation">,</span> <span class="token string">'__hash__'</span><span class="token punctuation">,</span> <span class="token string">'__index__'</span><span class="token punctuation">,</span> <span class="token string">'__init__'</span><span class="token punctuation">,</span> <span class="token string">'__init_subclass__'</span><span class="token punctuation">,</span> <span class="token string">'__int__'</span><span class="token punctuation">,</span> <span class="token string">'__invert__'</span><span class="token punctuation">,</span> <span class="token string">'__le__'</span><span class="token punctuation">,</span> <span class="token string">'__lshift__'</span><span class="token punctuation">,</span> <span class="token string">'__lt__'</span><span class="token punctuation">,</span> <span class="token string">'__mod__'</span><span class="token punctuation">,</span> <span class="token string">'__mul__'</span><span class="token punctuation">,</span> <span class="token string">'__ne__'</span><span class="token punctuation">,</span> <span class="token string">'__neg__'</span><span class="token punctuation">,</span> <span class="token string">'__new__'</span><span class="token punctuation">,</span> <span class="token string">'__or__'</span><span class="token punctuation">,</span> <span class="token string">'__pos__'</span><span class="token punctuation">,</span> <span class="token string">'__pow__'</span><span class="token punctuation">,</span> <span class="token string">'__radd__'</span><span class="token punctuation">,</span> <span class="token string">'__rand__'</span><span class="token punctuation">,</span> <span class="token string">'__rdivmod__'</span><span class="token punctuation">,</span> <span class="token string">'__reduce__'</span><span class="token punctuation">,</span> <span class="token string">'__reduce_ex__'</span><span class="token punctuation">,</span> <span class="token string">'__repr__'</span><span class="token punctuation">,</span> <span class="token string">'__rfloordiv__'</span><span class="token punctuation">,</span> <span class="token string">'__rlshift__'</span><span class="token punctuation">,</span> <span class="token string">'__rmod__'</span><span class="token punctuation">,</span> <span class="token string">'__rmul__'</span><span class="token punctuation">,</span> <span class="token string">'__ror__'</span><span class="token punctuation">,</span> <span class="token string">'__round__'</span><span class="token punctuation">,</span> <span class="token string">'__rpow__'</span><span class="token punctuation">,</span> <span class="token string">'__rrshift__'</span><span class="token punctuation">,</span> <span class="token string">'__rshift__'</span><span class="token punctuation">,</span> <span class="token string">'__rsub__'</span><span class="token punctuation">,</span> <span class="token string">'__rtruediv__'</span><span class="token punctuation">,</span> <span class="token string">'__rxor__'</span><span class="token punctuation">,</span> <span class="token string">'__setattr__'</span><span class="token punctuation">,</span> <span class="token string">'__sizeof__'</span><span class="token punctuation">,</span> <span class="token string">'__str__'</span><span class="token punctuation">,</span> <span class="token string">'__sub__'</span><span class="token punctuation">,</span> <span class="token string">'__subclasshook__'</span><span class="token punctuation">,</span> <span class="token string">'__truediv__'</span><span class="token punctuation">,</span> <span class="token string">'__trunc__'</span><span class="token punctuation">,</span> <span class="token string">'__xor__'</span><span class="token punctuation">,</span> <span class="token string">'as_integer_ratio'</span><span class="token punctuation">,</span> <span class="token string">'bit_length'</span><span class="token punctuation">,</span> <span class="token string">'conjugate'</span><span class="token punctuation">,</span> <span class="token string">'denominator'</span><span class="token punctuation">,</span> <span class="token string">'from_bytes'</span><span class="token punctuation">,</span> <span class="token string">'imag'</span><span class="token punctuation">,</span> <span class="token string">'numerator'</span><span class="token punctuation">,</span> <span class="token string">'real'</span><span class="token punctuation">,</span> <span class="token string">'to_bytes'</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>可以看到，整数对象下具有<code>__add__</code>方法，这也是为什么我们可以直接在python中运算<code>1+2</code>,当python识别到<code>+</code>时，就去调用该对象的<code>__add__</code>方法来完成计算。比如我们想给自己的对象定义+方法：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">A</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>a <span class="token operator">=</span> a

    <span class="token keyword">def</span> <span class="token function">__add__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> others<span class="token punctuation">)</span><span class="token punctuation">:</span>

        <span class="token comment"># return self.a+others.a</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span>self<span class="token punctuation">.</span>a<span class="token punctuation">,</span> others<span class="token punctuation">.</span>a<span class="token punctuation">]</span>

a <span class="token operator">=</span> A<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
b <span class="token operator">=</span> A<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
c <span class="token operator">=</span> a <span class="token operator">+</span> b  <span class="token comment"># 自定义的__add__方法，实现是将两个对象的a属性合并到一个列表中</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>__add__<span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 等价于直接调用</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>同理，再举一个<code>__len__</code>魔法方法的例子来帮助理解。我们定义一个list对象l，通过dir(l)可以看到该对象中具有<code>__len__</code>方法，即表明在python中可以通过len(l)来返回其列表长度。我们在自己定义的对象中当然也可以自定第该方法，来实现我们想通过len()返回的结果。</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>l<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span>
<span class="token builtin">dir</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token string">'__add__'</span><span class="token punctuation">,</span> <span class="token string">'__class__'</span><span class="token punctuation">,</span> <span class="token string">'__contains__'</span><span class="token punctuation">,</span> <span class="token string">'__delattr__'</span><span class="token punctuation">,</span> <span class="token string">'__delitem__'</span><span class="token punctuation">,</span> <span class="token string">'__dir__'</span><span class="token punctuation">,</span> <span class="token string">'__doc__'</span><span class="token punctuation">,</span> <span class="token string">'__eq__'</span><span class="token punctuation">,</span> <span class="token string">'__format__'</span><span class="token punctuation">,</span> <span class="token string">'__ge__'</span><span class="token punctuation">,</span> <span class="token string">'__getattribute__'</span><span class="token punctuation">,</span> <span class="token string">'__getitem__'</span><span class="token punctuation">,</span> <span class="token string">'__gt__'</span><span class="token punctuation">,</span> <span class="token string">'__hash__'</span><span class="token punctuation">,</span> <span class="token string">'__iadd__'</span><span class="token punctuation">,</span> <span class="token string">'__imul__'</span><span class="token punctuation">,</span> <span class="token string">'__init__'</span><span class="token punctuation">,</span> <span class="token string">'__init_subclass__'</span><span class="token punctuation">,</span> <span class="token string">'__iter__'</span><span class="token punctuation">,</span> <span class="token string">'__le__'</span><span class="token punctuation">,</span> <span class="token string">'__len__'</span><span class="token punctuation">,</span> <span class="token string">'__lt__'</span><span class="token punctuation">,</span> <span class="token string">'__mul__'</span><span class="token punctuation">,</span> <span class="token string">'__ne__'</span><span class="token punctuation">,</span> <span class="token string">'__new__'</span><span class="token punctuation">,</span> <span class="token string">'__reduce__'</span><span class="token punctuation">,</span> <span class="token string">'__reduce_ex__'</span><span class="token punctuation">,</span> <span class="token string">'__repr__'</span><span class="token punctuation">,</span> <span class="token string">'__reversed__'</span><span class="token punctuation">,</span> <span class="token string">'__rmul__'</span><span class="token punctuation">,</span> <span class="token string">'__setattr__'</span><span class="token punctuation">,</span> <span class="token string">'__setitem__'</span><span class="token punctuation">,</span> <span class="token string">'__sizeof__'</span><span class="token punctuation">,</span> <span class="token string">'__str__'</span><span class="token punctuation">,</span> <span class="token string">'__subclasshook__'</span><span class="token punctuation">,</span> <span class="token string">'append'</span><span class="token punctuation">,</span> <span class="token string">'clear'</span><span class="token punctuation">,</span> <span class="token string">'copy'</span><span class="token punctuation">,</span> <span class="token string">'count'</span><span class="token punctuation">,</span> <span class="token string">'extend'</span><span class="token punctuation">,</span> <span class="token string">'index'</span><span class="token punctuation">,</span> <span class="token string">'insert'</span><span class="token punctuation">,</span> <span class="token string">'pop'</span><span class="token punctuation">,</span> <span class="token string">'remove'</span><span class="token punctuation">,</span> <span class="token string">'reverse'</span><span class="token punctuation">,</span> <span class="token string">'sort'</span><span class="token punctuation">]</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 3</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>自定义一个对象：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">B</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>a<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>a<span class="token operator">=</span>a
        
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>b<span class="token operator">=</span>B<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span><span class="token builtin">len</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token comment">#因为对象中未定义__len__，因此调用len(b)会报错，没有该方法</span>
Traceback <span class="token punctuation">(</span>most recent call last<span class="token punctuation">)</span><span class="token punctuation">:</span>
  File <span class="token string">&quot;&lt;input&gt;&quot;</span><span class="token punctuation">,</span> line <span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">in</span> <span class="token operator">&lt;</span>module<span class="token operator">&gt;</span>
TypeError<span class="token punctuation">:</span> <span class="token builtin">object</span> of <span class="token builtin">type</span> <span class="token string">'B'</span> has no <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    
<span class="token comment">#添加__len__方法</span>
<span class="token keyword">class</span> <span class="token class-name">B</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>a<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>a<span class="token operator">=</span>a
    <span class="token keyword">def</span> <span class="token function">__len__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'this is magic method len'</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token number">2</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>a<span class="token operator">=</span>B<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span>
this <span class="token keyword">is</span> magic method <span class="token builtin">len</span>
<span class="token number">2</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>可以看到，魔术方法在类或对象的某些事件出发后会自动执行，如果希望根据自己的程序定制特殊功能的类，那么就需要对这些方法进行重写。使用这些「<strong>魔法方法</strong>」，我们可以非常方便地给类添加特殊的功能。</p> <h1 id="_2-常用的魔法方法"><a href="#_2-常用的魔法方法" class="header-anchor">#</a> <strong><strong>2. 常用的魔法方法</strong></strong></h1> <p>魔法方法大致分为如下几类：</p> <ul><li>构造与初始化</li> <li>类的表示</li> <li>访问控制</li> <li>比较、运算等操作</li> <li>容器类操作</li> <li>可调用对象</li> <li>序列化</li></ul> <h2 id="_2-1-构造与初始化"><a href="#_2-1-构造与初始化" class="header-anchor">#</a> 2.1 构造与初始化</h2> <p>对类的初始化一般会涉及三个魔法方法，<code>__init__</code>,<code>__new__</code>和<code>__del__</code>;</p> <h3 id="init"><a href="#init" class="header-anchor">#</a> <code>**__init__**</code></h3> <p>使用场景：定义类时</p> <p>在创建类时，我们可以手动添加一个 <strong>init</strong>() 方法，该方法是一个特殊的类实例方法，称为构造方法（或构造函数）。</p> <p><em>init</em>_() 方法可以包含多个参数，但必须包含一个名为 self 的参数，且必须作为第一个参数。也就是说，类的构造方法最少也要有一个 self 参数。</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">TheFirstDemo</span><span class="token punctuation">:</span>
    <span class="token comment"># 构造方法(创建实例的时候会先执行__new__方法，然后在执行__init__方法)</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;调用构造方法&quot;</span><span class="token punctuation">)</span>

TheFirstDemo<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token triple-quoted-string string">&quot;&quot;&quot;
调用构造方法
&quot;&quot;&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="new"><a href="#new" class="header-anchor">#</a> <code>__new__</code></h3> <p><strong>使用场景：<code>__new__</code>的使用场景如单例模式、工厂模式，以及一些不可变对象的继承上。这类应用非常值得关注并使用，可以大大的让代码看起来优美和简洁</strong></p> <p>当我们初始化一个类是，a=A(1)，首先调用的并不是<code>__init__</code>函数，而是<code>__new__</code>；初始化一个类有两步，分别为：</p> <ol><li>调用该类的<code>__new__</code>方法，并返回该类的实例对象；</li> <li>调用该类的<code>__init__</code>方法，对实例对象进行初始化。</li></ol> <p>其中<code>__new__</code>用法如下：</p> <p>(1) <code>__new__(cls,*args,**kwargs)</code>:至少要有一个参数<code>cls</code>，代表传入的类，此参数在实例化时由 Python 解释器自动提供，若返回该类的对象实例(self)，后面的参数直接传递给<code>__init__</code>。</p> <p>(2) <code>__new__</code>可以决定是否使用<code>__init__</code>方法，但是，执行了<code>__new__</code>，并不一定会进<code>__init__</code>，只有<code>__new__</code>返回了，当前类<code>cls</code>的实例，当前类的<code>__init__</code>才会进入。即使返回父类的实例也不行，必须是当前类的实例；</p> <p>(3) object将<code>__new__()</code>方法定义为静态方法，并且至少需要传递一个参数cls，cls表示需要实例化的类，此参数在实例化时由Python解释器自动提供。</p> <p>(4) <code>__init__()</code>有一个参数self，该self参数就是<code>__new__()</code>返回的实例</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">A</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'this is A init'</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>a<span class="token operator">=</span>a
        self<span class="token punctuation">.</span>b<span class="token operator">=</span>b
    <span class="token keyword">def</span> <span class="token function">__new__</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'this is A new'</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'args:%s'</span><span class="token operator">%</span>args<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'kwargs:%s'</span><span class="token operator">%</span>kwargs<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>cls<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">.</span>__new__<span class="token punctuation">(</span>cls<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#&lt;__main__.A object at 0x000001BCD98FB3D0&gt;，一个A的对象实例</span>
        <span class="token keyword">return</span> <span class="token builtin">object</span><span class="token punctuation">.</span>__new__<span class="token punctuation">(</span>cls<span class="token punctuation">)</span><span class="token comment">#创建实例并返回</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>a<span class="token operator">=</span>A<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>b<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
this <span class="token keyword">is</span> A new  <span class="token comment"># 先进入__new__</span>
args<span class="token punctuation">:</span><span class="token number">1</span>
kwargs<span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token string">'b'</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'__main__.A'</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>__main__<span class="token punctuation">.</span>A <span class="token builtin">object</span> at <span class="token number">0x000001BCD98FB3D0</span><span class="token operator">&gt;</span>
this <span class="token keyword">is</span> A init  <span class="token comment"># 再进入__init__</span>
<span class="token operator">&lt;</span>__main__<span class="token punctuation">.</span>A <span class="token builtin">object</span> at <span class="token number">0x000001D0BC3EB3D0</span><span class="token operator">&gt;</span><span class="token comment">#self就是__new__返回的对象实例</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>其中object是所有类的基类<code>object.__new__</code>则返回当前传入类cls的实例对象；当前类的<code>__new__</code>
返回当前类的实例对象后，再进入<code>__init__</code>对实例进行初始化。</p> <p><strong>如果 <code>__new__</code>未返回当前类的实例，则不会进入当前类的<code>__init__</code></strong></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">A</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'this is A init'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>a<span class="token operator">=</span>a
        self<span class="token punctuation">.</span>b<span class="token operator">=</span>b
    <span class="token keyword">def</span> <span class="token function">__new__</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'this is A new'</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'args:%s'</span><span class="token operator">%</span>args<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'kwargs:%s'</span><span class="token operator">%</span>kwargs<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>cls<span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>m<span class="token operator">=</span>A<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>b<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
this <span class="token keyword">is</span> A new
args<span class="token punctuation">:</span><span class="token number">1</span>
kwargs<span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token string">'b'</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'__main__.A'</span><span class="token operator">&gt;</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span><span class="token keyword">print</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token comment">#报错，未进入到当前类的__init__进行初始化</span>
AttributeError<span class="token punctuation">:</span> <span class="token string">'NoneType'</span> <span class="token builtin">object</span> has no attribute <span class="token string">'a'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>进一步，<code>__new__</code>返回的是其它实例，当前实例的<code>__init__</code>也不会调用</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>a<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'this is A init'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>a<span class="token operator">=</span>a
    <span class="token keyword">def</span> <span class="token function">__new__</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'this is A new'</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>cls<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">.</span>__new__<span class="token punctuation">(</span>cls<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token builtin">object</span><span class="token punctuation">.</span>__new__<span class="token punctuation">(</span>cls<span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">B</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>a<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'this is B init'</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">__new__</span><span class="token punctuation">(</span>cls <span class="token punctuation">,</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'this is B new'</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>cls<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__new__<span class="token punctuation">(</span>A<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token comment">#这里返回的是A的实例对象&lt;__main__.A object at 0x000002A08683B370&gt;，因此不会调用B的__init__；</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>m<span class="token operator">=</span>B<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment">#初始化过程中，调用的顺序为：子类B的__new__》父类A的__new__，调用Object.__new__返回A的实例对象》返回到子类B的__new__中，返回A对象的实例，不是B的对象实例，因此不再调用B的__init__</span>
this <span class="token keyword">is</span> B new
<span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'__main__.B'</span><span class="token operator">&gt;</span>
this <span class="token keyword">is</span> A new
<span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'__main__.A'</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>__main__<span class="token punctuation">.</span>A <span class="token builtin">object</span> at <span class="token number">0x000002A08683B370</span><span class="token operator">&gt;</span>

<span class="token comment">#修改子类的__new__：</span>
<span class="token keyword">class</span> <span class="token class-name">B</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>a<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'this is B init'</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">__new__</span><span class="token punctuation">(</span>cls <span class="token punctuation">,</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># cls默认代表传入</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'this is B new'</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>cls<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__new__<span class="token punctuation">(</span>cls<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>  <span class="token comment"># 即是通过super()调用父类object的初始__new__方法来创建实例。返回B的对象实例</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>m<span class="token operator">=</span>B<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
this <span class="token keyword">is</span> B new
<span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'__main__.B'</span><span class="token operator">&gt;</span>
this <span class="token keyword">is</span> A new
<span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'__main__.B'</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>__main__<span class="token punctuation">.</span>B <span class="token builtin">object</span> at <span class="token number">0x00000167C541B370</span><span class="token operator">&gt;</span>
this <span class="token keyword">is</span> A init
this <span class="token keyword">is</span> B init

<span class="token comment">#调用顺序：</span>
<span class="token comment"># 调用B的__new__》传入B对象，调用A的__new__，调用object.__new__，返回B的实例》返回到B的__new__中》调用B的__init__》调用父类A的__init__，初始化并继承A的属性》继续B的__init__属性重写；</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br></div></div><h3 id="del"><a href="#del" class="header-anchor">#</a> <code>__del__</code></h3> <p>使用场景：当需要操作应用对象的时候</p> <p>而<code>__del__</code>方法则是当对象被系统回收的时候调用的魔法方法，在对象生命周期调用结束时调用该方法。</p> <p>Python 采用自动引用计数（ARC）方式来回收对象所占用的空间，当程序中有一个变量引用该 Python 对象时，Python 会自动保证该对象引用计数为 1；当程序中有两个变量引用该 Python 对象时，Python 会自动保证该对象引用计数为 2，依此类推，如果一个对象的引用计数变成了 0，则说明程序中不再有变量引用该对象，表明程序不再需要该对象，因此 Python 就会回收该对象。所以大部分时候，都不需要我们手动去删掉不再使用的对象，python的回收机制会自动帮我们做这件事。</p> <p><em><code>本质：每创建一个对象引用计数加1，对象销毁后自动减一，当引用计数为0的时候，自动触发__del__函数</code></em></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token triple-quoted-string string">&quot;&quot;&quot;
本质：每创建一个对象引用计数加1，对象销毁后自动减一，当引用计数为0的时候，自动触发__del__函数
&quot;&quot;&quot;</span>

<span class="token keyword">class</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'this is A init'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>a <span class="token operator">=</span> a

    <span class="token keyword">def</span> <span class="token function">__del__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'this is magic method del'</span><span class="token punctuation">)</span>

m <span class="token operator">=</span> A<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token comment"># this is A init</span>
n <span class="token operator">=</span> A<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
n1 <span class="token operator">=</span> n
<span class="token comment"># this is A init</span>
<span class="token keyword">del</span> m  <span class="token comment"># m被删除，这个对象的引用数为0；自动调用其del方法</span>
<span class="token comment"># this is magic method del</span>
<span class="token keyword">del</span> n  <span class="token comment"># 还有一个n1被引用</span>
<span class="token keyword">del</span> n1
<span class="token triple-quoted-string string">&quot;&quot;&quot;
this is A init
this is A init
this is magic method del
this is magic method del
&quot;&quot;&quot;</span>

<span class="token comment"># this is magic method del</span>

<span class="token comment"># 进一步，查看python的自动回收机制，不用del去手动删除实例</span>
<span class="token keyword">def</span> <span class="token function">func</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>
    x <span class="token operator">=</span> A<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">.</span>a
    y <span class="token operator">=</span> b
    <span class="token keyword">return</span> x <span class="token operator">+</span> y

func<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token comment"># this is A init</span>
<span class="token comment"># this is magic method del#因为函数调用返回后，x和y自动被销毁；因此会触发__del__</span>
<span class="token comment"># 3</span>

<span class="token triple-quoted-string string">&quot;&quot;&quot;
this is A init
this is magic method del
&quot;&quot;&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br></div></div><h2 id="_2-2-控制属性访问"><a href="#_2-2-控制属性访问" class="header-anchor">#</a> <strong><strong>2.2 控制属性访问</strong></strong></h2> <p>这类魔法方法主要用于再对对象的属性进行访问、定义、修改时起作用。主要有：</p> <ul><li><code>__getattr__(self, name)</code>: 定义当用户试图获取一个属性时的行为。</li> <li><code>__getattribute__(self, name)</code>：定义当该类的属性被访问时的行为（先调用该方法，查看是否存在该属性，若不存在，接着去调用<code>__getattr__</code>）。</li> <li><code>__setattr__(self, name, value)</code>：定义当一个属性被设置时的行为。</li> <li><code>__delattr__(self, name)</code>：定义当一个属性被删除时的行为。</li></ul> <p>当初始化属性时如<code>self.a=a</code>时或修改实例属性如<code>ins.a=1</code>时本质时调用魔法方法<code>self.__setattr__(name,values)</code>；</p> <p>当实例访问某个属性如<code>ins.a</code>本质是调用魔法方法<code>a.__getattr__(name)</code>;</p> <p>当删除对象某个属性如<code>delattr(ins,'a')</code>本质是调用魔法方法<code>a.__delattr__(name)</code></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>a<span class="token operator">=</span>a
        self<span class="token punctuation">.</span>b<span class="token operator">=</span>b

    <span class="token keyword">def</span> <span class="token function">__setattr__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span>value<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'this is magic method setattr'</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">__getattr__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> item<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'getattr:%s'</span><span class="token operator">%</span>item<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'this is magic method getattr'</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">__delattr__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> item<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'delattr:%s'</span><span class="token operator">%</span>item<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'this is magic method delattr'</span><span class="token punctuation">)</span>
        
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>m<span class="token operator">=</span>A<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
a <span class="token number">1</span>
this <span class="token keyword">is</span> magic method <span class="token builtin">setattr</span>  <span class="token comment"># 初始化self.a=a时调用 __setattr__</span>
b <span class="token number">2</span>
this <span class="token keyword">is</span> magic method <span class="token builtin">setattr</span>  <span class="token comment"># 初始化self.b=b时调用 __setattr__</span>

<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>a<span class="token operator">=</span>m<span class="token punctuation">.</span>a
<span class="token builtin">getattr</span><span class="token punctuation">:</span>a
this <span class="token keyword">is</span> magic method <span class="token builtin">getattr</span>  <span class="token comment"># 访问属性a时调用__getattr__</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>m<span class="token punctuation">.</span>b<span class="token operator">=</span><span class="token number">100</span>
b <span class="token number">100</span>
this <span class="token keyword">is</span> magic method <span class="token builtin">setattr</span>  <span class="token comment"># 修改属性b时调用__setattr__</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span><span class="token builtin">delattr</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span><span class="token string">'a'</span><span class="token punctuation">)</span>
<span class="token builtin">delattr</span><span class="token punctuation">:</span>a
this <span class="token keyword">is</span> magic method <span class="token builtin">delattr</span>  <span class="token comment"># 删除属性a时调用__delattr__</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span><span class="token keyword">print</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span>a<span class="token punctuation">)</span>
<span class="token builtin">getattr</span><span class="token punctuation">:</span>a
this <span class="token keyword">is</span> magic method <span class="token builtin">getattr</span>
<span class="token boolean">None</span><span class="token comment">#属性a被删除，为None</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><p>上面的代码有一些隐患，<strong>因为我们重载了<code>__setattr__</code>，因此属性初始化时就调用重载后的<code>__setattr__</code>；但是在初始化属性调用<code>__setattr__</code>时需要配合实例的属性管理<code>__dict__</code>来进行，即需要将属性都在<code>self.__dict__</code>中进行注册，否则实例是访问不到这些属性的</strong>。如</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span><span class="token keyword">print</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span>a<span class="token punctuation">)</span>
<span class="token builtin">getattr</span><span class="token punctuation">:</span>a
this <span class="token keyword">is</span> magic method <span class="token builtin">getattr</span>
<span class="token boolean">None</span>  <span class="token comment"># 可以看到，并没有初始化成功为a=1，因为重载的__setattr__方法内部尚未将属性在__dict__中注册</span>

<span class="token comment">#修改上面的__setattr__:</span>
<span class="token keyword">class</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>a<span class="token operator">=</span>a
        self<span class="token punctuation">.</span>b<span class="token operator">=</span>b
    <span class="token keyword">def</span> <span class="token function">__setattr__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span>value<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'this is magic method setattr'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>__dict__<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token comment">#在__dict__注册实例属性</span>
        <span class="token comment">#super().__setattr__(key,value) 也可以通过继承的方式来实现；</span>

    <span class="token keyword">def</span> <span class="token function">__getattr__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> item<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'getattr:%s'</span><span class="token operator">%</span>item<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'this is magic method getattr'</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">f</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>__dict__<span class="token comment">#查看属性管理字典</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>m<span class="token operator">=</span>A<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>m<span class="token punctuation">.</span>a
<span class="token number">1</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>m<span class="token punctuation">.</span>f<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span><span class="token string">'a'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p>其中，重载<code>__setattr__</code>时一定要配合<code>__dict__</code>，或者在添加了自定义的功能后，通过继承来完成该方法，不然容易陷入无线递归的陷阱。</p> <p>控制属性重载的使用场景：如在初始化属性时先对属性的值进行拦截，进行相应的处理或者判断（比如类型判断，或者范围判断）；</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>age<span class="token punctuation">,</span>sex<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>age<span class="token operator">=</span>age
        self<span class="token punctuation">.</span>sex<span class="token operator">=</span>sex

    <span class="token keyword">def</span> <span class="token function">__setattr__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> key<span class="token operator">==</span><span class="token string">'age'</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token number">0</span><span class="token operator">&lt;=</span>value<span class="token operator">&lt;=</span><span class="token number">100</span><span class="token punctuation">:</span>
                <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">'age must between 0 and 100'</span><span class="token punctuation">)</span>
        <span class="token keyword">elif</span> key<span class="token operator">==</span><span class="token string">'age'</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token punctuation">(</span>value<span class="token operator">==</span><span class="token string">'male'</span> <span class="token keyword">or</span> value<span class="token operator">==</span><span class="token string">'female'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">'sex must be male of female'</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">pass</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__setattr__<span class="token punctuation">(</span>key<span class="token punctuation">,</span>value<span class="token punctuation">)</span>  <span class="token comment"># 调用父类的方法</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>m<span class="token operator">=</span>A<span class="token punctuation">(</span>age<span class="token operator">=</span><span class="token number">102</span><span class="token punctuation">,</span>sex<span class="token operator">=</span><span class="token string">'male'</span><span class="token punctuation">)</span>
Exception<span class="token punctuation">:</span> age must between <span class="token number">0</span> <span class="token keyword">and</span> <span class="token number">100</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>m<span class="token operator">=</span>A<span class="token punctuation">(</span>age<span class="token operator">=</span><span class="token number">90</span><span class="token punctuation">,</span>sex<span class="token operator">=</span><span class="token string">'hhh'</span><span class="token punctuation">)</span>
Exception<span class="token punctuation">:</span> sex must be male of female
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>m<span class="token operator">=</span>A<span class="token punctuation">(</span>age<span class="token operator">=</span><span class="token number">90</span><span class="token punctuation">,</span>sex<span class="token operator">=</span><span class="token string">'male'</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span><span class="token keyword">print</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span>sex<span class="token punctuation">,</span>m<span class="token punctuation">.</span>age<span class="token punctuation">)</span>
male <span class="token number">90</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h2 id="_2-3-容器类操作"><a href="#_2-3-容器类操作" class="header-anchor">#</a> <strong><strong>2.3 容器类操作</strong></strong></h2> <p>有一些方法可以让我们自己定义自己的容器，就像python内置的list,tuple,dict等；</p> <p>容器分为可变容器和不可变容器,这里的细节需要去了解相关的协议。</p> <ul><li>如果自定义一个不可变容器的话，只能定义<code>__len__</code>和<code>__getitem__</code>；</li> <li>定义一个可变容器除了不可变容器的所有魔法方法，还需要定义<code>__setitem__</code>和<code>__delitem__</code>；如果容器可迭代。还需要定义<code>__iter__</code></li></ul> <p>主要有以下方法：</p> <ul><li><code>__len__(self)</code>:返回容器的长度</li> <li><code>__getitem__(self,key)</code>:当需要执行self[key]的方式去调用容器中的对象，调用的是该方法</li> <li><code>__setitem__(self,key,value)</code>:当需要执行self[key] = value时，调用的是该方法。</li> <li><code>__delitem__(self, key)</code>:当需要执行 del self[key]时，需要调用该方法；</li> <li><code>__iter__(self)</code>:当容器可以执行 for x in container: ，或者使用iter(container)时，需要定义该方法</li> <li><code>__reversed__(self)</code>:实现当reversed()被调用时的行为。应该返回序列反转后的版本。仅当序列可以是有序的时候实现它，例如对于列表或者元组。</li> <li><code>__contains__(self, item)</code>：定义了调用in和not in来测试成员是否存在的时候所产生的行为。</li></ul> <h3 id="len"><a href="#len" class="header-anchor">#</a> <code>__len__</code></h3> <p>返回容器的长度，在类中定义了<code>__len__</code> 方法 则可以使用 len 获取长度</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># 获取列表的长度</span>
<span class="token keyword">class</span> <span class="token class-name">LenStr</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> list1<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>list1 <span class="token operator">=</span> list1

    <span class="token keyword">def</span> <span class="token function">__len__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>list1<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">100</span>

x <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
l <span class="token operator">=</span> LenStr<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 类中没有定义 __len__ 则不可以使用 len方法</span>

<span class="token triple-quoted-string string">&quot;&quot;&quot;
103
&quot;&quot;&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="getitem-、-setitem-、-delitem"><a href="#getitem-、-setitem-、-delitem" class="header-anchor">#</a> <code>__getitem__、__setitem__、__delitem__</code></h3> <ul><li><code>__getitem__(self,key)</code>:当需要执行self[key]的方式去调用容器中的对象，调用的是该方法。（定义获取元素的行为，当使用索引操作符[]访问对象时调用。）</li> <li><code>__setitem__(self,key,value)</code>:当需要执行self[key] = value时，调用的是该方法。（定义设置元素的行为，当使用索引操作符[]=赋值给对象时调用。）</li> <li><code>__delitem__(self, key)</code>:当需要执行 del self[key]时，需要调用该方法。（定义删除元素的行为，当使用del语句删除对象中的元素时调用。）</li></ul> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token triple-quoted-string string">&quot;&quot;&quot;
- `__getitem__(self,key)`:当需要执行self[key]的方式去调用容器中的对象，调用的是该方法。（定义获取元素的行为，当使用索引操作符[]访问对象时调用。）
- `__setitem__(self,key,value)`:当需要执行self[key] = value时，调用的是该方法。（定义设置元素的行为，当使用索引操作符[]=赋值给对象时调用。）
- `__delitem__(self, key)`:当需要执行 del self[key]时，需要调用该方法。（定义删除元素的行为，当使用del语句删除对象中的元素时调用。）

&quot;&quot;&quot;</span>

<span class="token keyword">class</span> <span class="token class-name">MyList</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>data <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__repr__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">&quot;&quot;&quot;直接显示对象的值&quot;&quot;&quot;</span>
        <span class="token keyword">return</span> <span class="token builtin">repr</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>data<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__getitem__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">&quot;&quot;&quot;获取元素时触发&quot;&quot;&quot;</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;__getitem__&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>data<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">5</span>

    <span class="token keyword">def</span> <span class="token function">__setitem__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> index<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">&quot;&quot;&quot;设置元素时触发&quot;&quot;&quot;</span>

        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;__setitem__&quot;</span><span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>data<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> value

    <span class="token keyword">def</span> <span class="token function">__delitem__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">&quot;&quot;&quot;删除元素时触发&quot;&quot;&quot;</span>

        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;__delitem__&quot;</span><span class="token punctuation">)</span>

        <span class="token keyword">del</span> self<span class="token punctuation">.</span>data<span class="token punctuation">[</span>index<span class="token punctuation">]</span>

mylist <span class="token operator">=</span> MyList<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>mylist<span class="token punctuation">)</span>  <span class="token comment"># [1, 2, 3]</span>

<span class="token comment"># 获取元素</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>mylist<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 1</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>mylist<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 3</span>

<span class="token comment"># 设置元素</span>
mylist<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">4</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>mylist<span class="token punctuation">)</span>  <span class="token comment"># [4, 2, 3]</span>

<span class="token comment"># 删除元素</span>
<span class="token keyword">del</span> mylist<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>mylist<span class="token punctuation">)</span>  <span class="token comment"># [4, 3]</span>

<span class="token triple-quoted-string string">&quot;&quot;&quot;
[1, 2, 3]
__getitem__
6
__getitem__
8
__setitem__
[4, 2, 3]
__delitem__
[4, 3]
&quot;&quot;&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br></div></div><h3 id="iter"><a href="#iter" class="header-anchor">#</a> <code>__iter__</code></h3> <p>用于定义一个可迭代对象。如果一个类实现了<code>__iter__</code>方法并返回了一个迭代器对象，那么这个类的实例就可以被遍历，支持for循环操作。</p> <p>在<code>__iter__</code>方法中，需要返回一个迭代器对象，通常是该类的一个实例。这个迭代器对象要实现<code>__next__</code>方法，用于返回下一个元素的值，并在没有更多元素时抛出StopIteration异常。</p> <p>当容器可以执行 for x in container: ，或者使用iter(container)时，需要定义该方法</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">MyRange</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> start<span class="token punctuation">,</span> end<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>start <span class="token operator">=</span> start
        self<span class="token punctuation">.</span>end <span class="token operator">=</span> end

    <span class="token keyword">def</span> <span class="token function">__iter__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>current <span class="token operator">=</span> self<span class="token punctuation">.</span>start
        <span class="token keyword">return</span> self

    <span class="token keyword">def</span> <span class="token function">__next__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>current <span class="token operator">&gt;=</span> self<span class="token punctuation">.</span>end<span class="token punctuation">:</span>
            <span class="token keyword">raise</span> StopIteration
        value <span class="token operator">=</span> self<span class="token punctuation">.</span>current
        self<span class="token punctuation">.</span>current <span class="token operator">+=</span> <span class="token number">1</span>
        <span class="token keyword">return</span> value

<span class="token comment"># 使用自定义的MyRange类</span>
my_range <span class="token operator">=</span> MyRange<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> num <span class="token keyword">in</span> my_range<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h3 id="reversed"><a href="#reversed" class="header-anchor">#</a> <code>__reversed__</code></h3> <p>当一个对象需要支持反向迭代功能时，可以在该对象的类中定义<code>__reversed__</code>方法，并使其返回一个反向迭代器。反向迭代器是一个实现了<code>__next__</code>方法的对象，每次调用<code>__next__</code>方法可以返回序列中的前一个元素，直到序列结束时抛出StopIteration异常。</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">MyReverseIterator</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>index <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span>
        self<span class="token punctuation">.</span>data <span class="token operator">=</span> data

    <span class="token keyword">def</span> <span class="token function">__iter__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self

    <span class="token keyword">def</span> <span class="token function">__next__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>index <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token keyword">raise</span> StopIteration
        value <span class="token operator">=</span> self<span class="token punctuation">.</span>data<span class="token punctuation">[</span>self<span class="token punctuation">.</span>index<span class="token punctuation">]</span>
        self<span class="token punctuation">.</span>index <span class="token operator">-=</span> <span class="token number">1</span>
        <span class="token keyword">return</span> value

<span class="token keyword">class</span> <span class="token class-name">MyClass</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>

    <span class="token keyword">def</span> <span class="token function">__reversed__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> MyReverseIterator<span class="token punctuation">(</span>self<span class="token punctuation">.</span>data<span class="token punctuation">)</span>

my_obj <span class="token operator">=</span> MyClass<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> value <span class="token keyword">in</span> <span class="token builtin">reversed</span><span class="token punctuation">(</span>my_obj<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>

<span class="token comment"># Output:</span>
<span class="token comment"># 3</span>
<span class="token comment"># 2</span>
<span class="token comment"># 1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><h3 id="contains"><a href="#contains" class="header-anchor">#</a> <code>__contains__</code></h3> <p>当一个对象需要支持检查某个元素是否在其中时，可以在该对象的类中定义<code>__contains__</code>方法，并使其返回一个布尔值，表示该元素是否在该对象中。</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">MyContainer</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>data <span class="token operator">=</span> data

    <span class="token keyword">def</span> <span class="token function">__repr__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">&quot;&quot;&quot;直接显示对象的值&quot;&quot;&quot;</span>
        <span class="token keyword">return</span> <span class="token builtin">repr</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>data<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__contains__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> item<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> item <span class="token keyword">in</span> self<span class="token punctuation">.</span>data

my_container <span class="token operator">=</span> MyContainer<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>my_container<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token keyword">in</span> my_container<span class="token punctuation">)</span>  <span class="token comment"># True</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token number">4</span> <span class="token keyword">in</span> my_container<span class="token punctuation">)</span>  <span class="token comment"># False</span>

<span class="token triple-quoted-string string">&quot;&quot;&quot;
[1, 2, 3]
True
False
&quot;&quot;&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="面试题-自定义容器"><a href="#面试题-自定义容器" class="header-anchor">#</a> 面试题：自定义容器</h3> <p>下面举一个例子，实现一个容器，该容器有List的一般功能，同时增加一些其它功能如访问第一个元素，最后一个元素，记录每个元素被访问的次数等</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">SpecialList</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>values<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> values <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>values<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>values<span class="token operator">=</span>values
        self<span class="token punctuation">.</span>count<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">.</span>fromkeys<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>values<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment"># {0: 0, 1: 0, 2: 0}</span>

    <span class="token keyword">def</span> <span class="token function">__getitem__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#通过obj[key]访问容器内的对象</span>
        self<span class="token punctuation">.</span>count<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token operator">+=</span><span class="token number">1</span>  <span class="token comment"># 记录每次访问次数 </span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>values<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
    
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>a<span class="token operator">=</span>SpecialList<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 未定义魔法方法__len__，因此无法通过len()调用</span>
TypeError<span class="token punctuation">:</span> <span class="token builtin">object</span> of <span class="token builtin">type</span> <span class="token string">'SpecialList'</span> has no <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>b<span class="token operator">=</span>SpecialList<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span><span class="token keyword">print</span><span class="token punctuation">(</span>b<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment">#调用__getitem__方法</span>
<span class="token number">2</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>下面是完整例子：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">MyReverseIterator</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">:</span>
        data<span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>index <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span>
        self<span class="token punctuation">.</span>data <span class="token operator">=</span> data

    <span class="token keyword">def</span> <span class="token function">__iter__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self

    <span class="token keyword">def</span> <span class="token function">__next__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>index <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token keyword">raise</span> StopIteration
        value <span class="token operator">=</span> self<span class="token punctuation">.</span>data<span class="token punctuation">[</span>self<span class="token punctuation">.</span>index<span class="token punctuation">]</span>
        self<span class="token punctuation">.</span>index <span class="token operator">-=</span> <span class="token number">1</span>
        <span class="token keyword">return</span> value

<span class="token keyword">class</span> <span class="token class-name">SpecialList</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> values<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> values <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>values <span class="token operator">=</span> values
        self<span class="token punctuation">.</span>count <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">.</span>fromkeys<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>values<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__repr__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">&quot;&quot;&quot;直接显示对象的值&quot;&quot;&quot;</span>
        <span class="token keyword">return</span> <span class="token builtin">repr</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>values<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__len__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 通过len(obj)访问容器长度</span>
        <span class="token keyword">return</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>values<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__getitem__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 通过obj[key]访问容器内的对象</span>
        self<span class="token punctuation">.</span>count<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>values<span class="token punctuation">[</span>key<span class="token punctuation">]</span>

    <span class="token keyword">def</span> <span class="token function">__setitem__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 通过obj[key]=value去修改容器内的对象</span>
        self<span class="token punctuation">.</span>values<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> value

    <span class="token keyword">def</span> <span class="token function">__delitem__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 通过del obj[key]来删除容器内的对象</span>
        <span class="token keyword">del</span> self<span class="token punctuation">.</span>values<span class="token punctuation">[</span>key<span class="token punctuation">]</span>

    <span class="token keyword">def</span> <span class="token function">__iter__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 通过for 循环来遍历容器</span>
        <span class="token keyword">return</span> <span class="token builtin">iter</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>values<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__next__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 迭代的具体细节</span>
        <span class="token comment"># 如果__iter__返回时self 则必须实现此方法</span>
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>_index <span class="token operator">&gt;=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>values<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">raise</span> StopIteration<span class="token punctuation">(</span><span class="token punctuation">)</span>
        value <span class="token operator">=</span> self<span class="token punctuation">.</span>values<span class="token punctuation">[</span>self<span class="token punctuation">.</span>_index<span class="token punctuation">]</span>
        self<span class="token punctuation">.</span>_index <span class="token operator">+=</span> <span class="token number">1</span>
        <span class="token keyword">return</span> value

    <span class="token keyword">def</span> <span class="token function">__reversed__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 通过reverse(obj)来反转容器内的对象</span>
        <span class="token keyword">return</span> MyReverseIterator<span class="token punctuation">(</span>self<span class="token punctuation">.</span>values<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__contains__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> item<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 通过 item in obj来判断元素是否在容器内</span>
        <span class="token keyword">return</span> item <span class="token keyword">in</span> self<span class="token punctuation">.</span>values

    <span class="token keyword">def</span> <span class="token function">append</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>values<span class="token punctuation">.</span>append<span class="token punctuation">(</span>value<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">head</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 获取第一个元素</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>values<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>

    <span class="token keyword">def</span> <span class="token function">tail</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 获取第一个元素之后的所有元素</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>values<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>

s_list <span class="token operator">=</span> SpecialList<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

s_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
s_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>s_list<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>s_list<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>s_list<span class="token punctuation">.</span>count<span class="token punctuation">)</span>
<span class="token keyword">for</span> value <span class="token keyword">in</span> <span class="token builtin">reversed</span><span class="token punctuation">(</span>s_list<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br></div></div><p>这类方法的使用场景主要在你需要定义一个满足需求的容器类数据结构时会用到，比如可以尝试自定义实现树结构、链表等数据结构（在collections中均已有），或者项目中需要定制的一些容器类型。</p> <h2 id="_2-4-类的表示"><a href="#_2-4-类的表示" class="header-anchor">#</a> <strong><strong>2.4 类的表示</strong></strong></h2> <p>类的表示相关的魔法方法主要有<code>__str__</code>、<code>__repr__</code>和<code>__bool__</code></p> <ul><li><code>__str__</code>主要是在打印对象print(obj)时，会隐式调用str(obj)，即调用类中的<code>__str__</code>方法；定了该方法就可以通过str(obj)来调用；</li> <li><code>__repr__</code>主要式在直接输出对象时的显示，会调用<code>__repr__</code>方法；定义了该方法就可以通过repr(obj)来调用。</li></ul> <h3 id="str-、-repr"><a href="#str-、-repr" class="header-anchor">#</a> <code>__str__</code>、<code>__repr__</code></h3> <p>这两个方法都是将类显示为字符串；</p> <p>举例（以datetime模块中的date对象举例）：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> datetime
today<span class="token operator">=</span>datetime<span class="token punctuation">.</span>date<span class="token punctuation">.</span>today<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span><span class="token keyword">print</span><span class="token punctuation">(</span>today<span class="token punctuation">)</span><span class="token comment">#调用date类的__str__方法来显示</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">07</span><span class="token operator">-</span><span class="token number">04</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>today<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">07</span><span class="token operator">-</span><span class="token number">04</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>today<span class="token comment">#调用date类的__repr__来显示</span>
datetime<span class="token punctuation">.</span>date<span class="token punctuation">(</span><span class="token number">2021</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>回溯到date类的源码，可以清晰的对上面的输出进行解释：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment">#date类中的__repr__和__str__方法定义： </span>
    <span class="token keyword">def</span> <span class="token function">__repr__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">&quot;&quot;&quot;Convert to formal string, for repr().

        &gt;&gt;&gt; dt = datetime(2010, 1, 1)
        &gt;&gt;&gt; repr(dt)
        'datetime.datetime(2010, 1, 1, 0, 0)'

        &gt;&gt;&gt; dt = datetime(2010, 1, 1, tzinfo=timezone.utc)
        &gt;&gt;&gt; repr(dt)
        'datetime.datetime(2010, 1, 1, 0, 0, tzinfo=datetime.timezone.utc)'
        &quot;&quot;&quot;</span>
        <span class="token keyword">return</span> <span class="token string">&quot;%s.%s(%d, %d, %d)&quot;</span> <span class="token operator">%</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__module__<span class="token punctuation">,</span>
                                      self<span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__qualname__<span class="token punctuation">,</span>
                                      self<span class="token punctuation">.</span>_year<span class="token punctuation">,</span>
                                      self<span class="token punctuation">.</span>_month<span class="token punctuation">,</span>
                                      self<span class="token punctuation">.</span>_day<span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">isoformat</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">&quot;&quot;&quot;Return the date formatted according to ISO.

            This is 'YYYY-MM-DD'.

            References:
            - http://www.w3.org/TR/NOTE-datetime
            - http://www.cl.cam.ac.uk/~mgk25/iso-time.html
            &quot;&quot;&quot;</span>
        <span class="token keyword">return</span> <span class="token string">&quot;%04d-%02d-%02d&quot;</span> <span class="token operator">%</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>_year<span class="token punctuation">,</span> self<span class="token punctuation">.</span>_month<span class="token punctuation">,</span> self<span class="token punctuation">.</span>_day<span class="token punctuation">)</span>

    __str__ <span class="token operator">=</span> isoformat
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><p>如果自定义类中不定义这两个魔法方法，则会用父类或者object类的默认表示方法，举例：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>a <span class="token operator">=</span> a
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>a <span class="token operator">=</span> A<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span><span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token comment">#调用__str__</span>
<span class="token operator">&lt;</span>__main__<span class="token punctuation">.</span>A <span class="token builtin">object</span> at <span class="token number">0x000001540B1F4DF0</span><span class="token operator">&gt;</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>a<span class="token comment">#调用__repr__</span>
<span class="token operator">&lt;</span>__main__<span class="token punctuation">.</span>A <span class="token builtin">object</span> at <span class="token number">0x000001540B1F4DF0</span><span class="token operator">&gt;</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span><span class="token builtin">str</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token comment">#调用__str__</span>
<span class="token string">'&lt;__main__.A object at 0x000001540B1F4DF0&gt;'</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#调用__str__</span>
<span class="token operator">&lt;</span>__main__<span class="token punctuation">.</span>A <span class="token builtin">object</span> at <span class="token number">0x000001540B1F4DF0</span><span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>可以看到，如果没有定义<code>__str__</code>和<code>__repr__</code>，则会调用默认的魔法方法（object的<code>__str__</code>和<code>__repr__</code>）即<code>obj.__class__ object at XXX</code>;</p> <p>只定义了<code>__str__</code>:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>a<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>a<span class="token operator">=</span>a
    <span class="token keyword">def</span> <span class="token function">__str__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">'(%s,%s)'</span><span class="token operator">%</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__name__<span class="token punctuation">,</span>self<span class="token punctuation">.</span>a<span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>a<span class="token operator">=</span>A<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span><span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
<span class="token punctuation">(</span>A<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>a<span class="token comment">#未定义__repr__，仍旧调用默认的__repr__方法</span>
<span class="token operator">&lt;</span>__main__<span class="token punctuation">.</span>A <span class="token builtin">object</span> at <span class="token number">0x000001540B215790</span><span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>只定义了<code>__repr__</code></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>a <span class="token operator">=</span> a
    <span class="token comment"># def __str__(self):</span>
    <span class="token comment">#     return '(%s,%s)'%(self.__class__.__name__,self.a)</span>
    <span class="token keyword">def</span> <span class="token function">__repr__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">'(repr:%s,%s)'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__name__<span class="token punctuation">,</span> self<span class="token punctuation">.</span>a<span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>a <span class="token operator">=</span> A<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>a<span class="token comment">#调用__repr__</span>
<span class="token punctuation">(</span><span class="token builtin">repr</span><span class="token punctuation">:</span>A<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span><span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token comment">#未定义__str__；转为调用__repr__；</span>
<span class="token punctuation">(</span><span class="token builtin">repr</span><span class="token punctuation">:</span>A<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span><span class="token builtin">str</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token comment">#未定义__str__；转为调用__repr__；</span>
<span class="token string">'(repr:A,1)'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>从上面可以看出，当自定义类中没有定义 <code>__str__()</code> 和 <code>__repr__()</code> 时，在进行对象的输出时，会调用默认的 <code>__str__()</code> 和 <code>__repr__()</code> ；当类中只包含 <code>__str__()</code> 时，调用 print() 或str()函数进行对象的输出，会调用 <code>__str__()</code>，直接输出调用默认的 <code>__repr__()</code>；当类中既包含 <code>__str__()</code> 又包含 <code>__repr__()</code> 时，调用 print() 或str()函数进行对象的输出，会调用 <code>__str__()</code>，直接输出会调用 <code>__repr__()</code>；当类中只包含 <code>__repr__()</code> 时，调用 print() 或str()函数进行对象的输出和直接输出都会调用 <code>__repr__()</code>。</p> <p>因此，对于自定义的类，建议定义<code>__str__</code>和<code>__repr__</code>，以更好的进行交互；其中<code>__str__</code>可以考虑设计为想转换输出的字符串，在后续str(obj)将对象转为特定的字符串输出时提供一些便利；<code>__repr__</code>可以考虑设计为输出较为详细的信息，如列名，甚至包括部分关键参数名，这样在开发的时候便于获取对象的准确信息（如sklearn中的机器学习模块就是如此设计）</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>a <span class="token operator">=</span> a

    <span class="token keyword">def</span> <span class="token function">__str__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">'(%s,%s)'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__name__<span class="token punctuation">,</span> self<span class="token punctuation">.</span>a<span class="token punctuation">)</span>

a <span class="token operator">=</span> A<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>a <span class="token operator">=</span> a

    <span class="token comment"># def __str__(self):</span>
    <span class="token comment">#     return '(%s,%s)'%(self.__class__.__name__,self.a)</span>

    <span class="token keyword">def</span> <span class="token function">__repr__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">'(repr:%s,%s)'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__name__<span class="token punctuation">,</span> self<span class="token punctuation">.</span>a<span class="token punctuation">)</span>

a <span class="token operator">=</span> A<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>  <span class="token comment"># 如果里面定义了__str__方法则会执行__str__ 没有的话则执行__repr__方法</span>

<span class="token triple-quoted-string string">&quot;&quot;&quot;
(A,1)
(repr:A,1)
&quot;&quot;&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h3 id="bool"><a href="#bool" class="header-anchor">#</a> <code>__bool__</code></h3> <p><code>_bool__</code>：当调用 bool(obj) 时，会调用 <code>__bool__()</code>方法，返回 True 或 False：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>a <span class="token operator">=</span> a

    <span class="token keyword">def</span> <span class="token function">__bool__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>a <span class="token operator">&gt;</span> <span class="token number">10</span>

a <span class="token operator">=</span> A<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">bool</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 如果未定义__bool__，则会调用内置的bool对象。因为继承object</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="_2-5-可调用对象"><a href="#_2-5-可调用对象" class="header-anchor">#</a> <strong><strong>2.5 可调用对象</strong></strong></h2> <h3 id="call"><a href="#call" class="header-anchor">#</a> <code>__call__</code></h3> <p>当一个对象需要支持像函数一样被调用时，可以在该对象的类中定义<code>__call__</code>方法。在调用该对象时，Python会调用该对象的<code>__call__</code>方法，并将调用时传入的参数传递给<code>__call__</code>方法。</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>a <span class="token operator">=</span> a
        self<span class="token punctuation">.</span>b <span class="token operator">=</span> b

    <span class="token keyword">def</span> <span class="token function">__call__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>a <span class="token operator">=</span> a

m <span class="token operator">=</span> A<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span>a<span class="token punctuation">,</span> m<span class="token punctuation">.</span>b<span class="token punctuation">,</span> <span class="token builtin">id</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span>

m<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>  <span class="token comment"># 像函数一样直接调用类，本质是调用的__call__方法,不实现__call__方法不能执行实例</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span>a<span class="token punctuation">,</span> m<span class="token punctuation">.</span>b<span class="token punctuation">,</span> <span class="token builtin">id</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token triple-quoted-string string">&quot;&quot;&quot;
1 2 2185670174656
100 2 2185670174656
&quot;&quot;&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p><code>__call__</code>方法的一些使用场景：自建一个简单的装饰器（实际例子如 bottle 框架源码的 <code>cached_property</code>）：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> func<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>func <span class="token operator">=</span> func

    <span class="token keyword">def</span> <span class="token function">__call__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'this is call'</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>func<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 调用f这个函数</span>

<span class="token decorator annotation punctuation">@A</span>  <span class="token comment"># 语法糖，相当于A(f)</span>
<span class="token keyword">def</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'hhh'</span><span class="token punctuation">)</span>

f<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 执行call方法</span>

<span class="token triple-quoted-string string">&quot;&quot;&quot;
this is call
hhh
&quot;&quot;&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>定义一个对象，对象中具有各类方法，但是核心功能只有一个，可以通过可调用对象来简单且直接的调用，不用每次都实例化对象。</p> <p>同样还可以用作抽象窗口函数，抽象出使用规则，通过子类的改写其他方法，在不改变原代码的情况下取得不同的结果，比如：</p> <h3 id="call子类的改写其他方法-在不改变原代码的情况下取得不同的结果"><a href="#call子类的改写其他方法-在不改变原代码的情况下取得不同的结果" class="header-anchor">#</a> call子类的改写其他方法，在不改变原代码的情况下取得不同的结果</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">CSVDataProcess</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span>

    <span class="token keyword">def</span> <span class="token function">example_one</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__call__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> exmaple<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            target_func <span class="token operator">=</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> exmaple<span class="token punctuation">)</span>
            target_func<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 执行传递过来的函数</span>
        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;execute error&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    csv <span class="token operator">=</span> CSVDataProcess<span class="token punctuation">(</span><span class="token punctuation">)</span>
    csv<span class="token punctuation">(</span><span class="token string">&quot;example_one&quot;</span><span class="token punctuation">)</span>  <span class="token comment"># 1</span>
<span class="token comment">#这个例子在子类继承时，子类重新实现example；通过调用子类直接就可以通过__call__来直接调用该子类的example方法；整个代码非常简洁了；</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h2 id="_2-6-序列化"><a href="#_2-6-序列化" class="header-anchor">#</a> <strong><strong>2.6 序列化</strong></strong></h2> <p>python中有一个pickle模块来对实例化对象进行序列化；如pickle.loads(obj),pickle.dumps(obj)等；</p> <p>在序列化的时候也是调用的内置魔法方法：</p> <ul><li><code>__getstate__()</code>:   用于python 对象的序列化,指定在序列化时将哪些信息记录下来</li> <li><code>__setstate__()</code>：用于python 对象的反序列化,指定在反序列化时指明如何利用信息</li></ul> <p>当一个对象需要被序列化为字节流或者字符串时，可以在该对象的类中定义<code>__getstate__</code>方法并返回一个表示对象状态的字典。当反序列化对象时，需要在该对象的类中定义<code>__setstate__</code>方法，接收一个表示对象状态的字典，并使用其中的信息来重构对象。</p> <h3 id="getstate-、-setstate"><a href="#getstate-、-setstate" class="header-anchor">#</a> <code>__getstate__、__setstate__</code></h3> <p>举例说明：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># 直接通过pickle保存一个对象实例,默认将该实例的属性、方法都保存下来；</span>
<span class="token keyword">class</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>a <span class="token operator">=</span> a
        self<span class="token punctuation">.</span>b <span class="token operator">=</span> b

<span class="token keyword">import</span> pickle  <span class="token comment"># 序列化，反序列化对象</span>

a <span class="token operator">=</span> A<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
a_1 <span class="token operator">=</span> pickle<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>a<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a_1<span class="token punctuation">)</span>
a_2 <span class="token operator">=</span> pickle<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>a_1<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a_2<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a_2<span class="token punctuation">.</span>a<span class="token punctuation">,</span> a_2<span class="token punctuation">.</span>b<span class="token punctuation">)</span>

<span class="token triple-quoted-string string">&quot;&quot;&quot;
b'\x80\x04\x95&amp;\x00\x00\x00\x00\x00\x00\x00\x8c\x08__main__\x94\x8c\x01A\x94\x93\x94)\x81\x94}\x94(\x8c\x01a\x94K\x01\x8c\x01b\x94K\x02ub.'
&lt;__main__.A object at 0x000002CF4439D280&gt;
1 2
&quot;&quot;&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>如果重写<code>__getstate__()__setstate__()</code>，如下：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>a <span class="token operator">=</span> a
        self<span class="token punctuation">.</span>b <span class="token operator">=</span> b

    <span class="token keyword">def</span> <span class="token function">__getstate__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'this is magic method __getstate__'</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token string">'a'</span><span class="token punctuation">:</span> self<span class="token punctuation">.</span>a<span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">:</span> self<span class="token punctuation">.</span>b<span class="token punctuation">}</span>  <span class="token comment"># 序列化时返回的，即为在反序列化时传入的state</span>

    <span class="token keyword">def</span> <span class="token function">__setstate__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> state<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'this is magic method __setstate__'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>a <span class="token operator">=</span> state<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span>
        self<span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token number">300</span>

<span class="token keyword">import</span> pickle

a <span class="token operator">=</span> A<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
a_1 <span class="token operator">=</span> pickle<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>a<span class="token punctuation">)</span>  <span class="token comment"># 调用__getstate__</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a_1<span class="token punctuation">)</span>
a_2 <span class="token operator">=</span> pickle<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>a_1<span class="token punctuation">)</span>  <span class="token comment"># 调用__setstate__</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a_2<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a_2<span class="token punctuation">.</span>a<span class="token punctuation">,</span> a_2<span class="token punctuation">.</span>b<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">&quot;&quot;&quot;
this is magic method __getstate__
b'\x80\x04\x95&amp;\x00\x00\x00\x00\x00\x00\x00\x8c\x08__main__\x94\x8c\x01A\x94\x93\x94)\x81\x94}\x94(\x8c\x01a\x94K\x01\x8c\x01b\x94K\x02ub.'
this is magic method __setstate__
&lt;__main__.A object at 0x00000218F2F427C0&gt;
1 300
&quot;&quot;&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h2 id="_2-7-反射"><a href="#_2-7-反射" class="header-anchor">#</a> <strong><strong>2.7 反射</strong></strong></h2> <p>我们可以控制怎么使用内置在函数sisinstance()和issubclass()方法 反射定义魔术方法. 这个魔术方法是:</p> <ul><li><code>__instancecheck__(self, instance)</code></li> <li><code>__subclasscheck__(self, subclass)</code></li></ul> <p>这两个方法定义在元类中在有意义</p> <h3 id="instancecheck-、-subclasscheck"><a href="#instancecheck-、-subclasscheck" class="header-anchor">#</a> <code>__instancecheck__、__subclasscheck__</code></h3> <p><code>__instancecheck__</code> 和 <code>__subclasscheck__</code> 是 Python 中用于自定义对象的类型判断的特殊方法。它们能够让我们自定义一个类，使其能够像内置类型一样被 <strong>isinstance()</strong> 或 <strong>issubclass()</strong> 函数使用。</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">Person</span><span class="token punctuation">:</span>
    <span class="token keyword">pass</span>

<span class="token keyword">class</span> <span class="token class-name">Student</span><span class="token punctuation">(</span>Person<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">pass</span>

<span class="token keyword">class</span> <span class="token class-name">Teacher</span><span class="token punctuation">(</span>Person<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">pass</span>

<span class="token keyword">class</span> <span class="token class-name">University</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> members<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>members <span class="token operator">=</span> members

    <span class="token keyword">def</span> <span class="token function">__len__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>members<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__getitem__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> item<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>members<span class="token punctuation">[</span>item<span class="token punctuation">]</span>

    <span class="token keyword">def</span> <span class="token function">__instancecheck__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> instance<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>instance<span class="token punctuation">,</span> Person<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__subclasscheck__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> subclass<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token builtin">issubclass</span><span class="token punctuation">(</span>subclass<span class="token punctuation">,</span> Person<span class="token punctuation">)</span>

person <span class="token operator">=</span> Person<span class="token punctuation">(</span><span class="token punctuation">)</span>
student <span class="token operator">=</span> Student<span class="token punctuation">(</span><span class="token punctuation">)</span>
teacher <span class="token operator">=</span> Teacher<span class="token punctuation">(</span><span class="token punctuation">)</span>
university <span class="token operator">=</span> University<span class="token punctuation">(</span><span class="token punctuation">[</span>person<span class="token punctuation">,</span> student<span class="token punctuation">,</span> teacher<span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">isinstance</span><span class="token punctuation">(</span>person<span class="token punctuation">,</span> Person<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># True</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">isinstance</span><span class="token punctuation">(</span>student<span class="token punctuation">,</span> Person<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># True</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">isinstance</span><span class="token punctuation">(</span>teacher<span class="token punctuation">,</span> Person<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># True</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">isinstance</span><span class="token punctuation">(</span>university<span class="token punctuation">,</span> Person<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># False</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">issubclass</span><span class="token punctuation">(</span>Person<span class="token punctuation">,</span> Person<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># True</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">issubclass</span><span class="token punctuation">(</span>Student<span class="token punctuation">,</span> Person<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># True</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">issubclass</span><span class="token punctuation">(</span>Teacher<span class="token punctuation">,</span> Person<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># True</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">issubclass</span><span class="token punctuation">(</span>University<span class="token punctuation">,</span> Person<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># False</span>

<span class="token triple-quoted-string string">&quot;&quot;&quot;
True
True
True
False
True
True
True
False
&quot;&quot;&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br></div></div><h2 id="_2-8-比较、运算、类型等操作"><a href="#_2-8-比较、运算、类型等操作" class="header-anchor">#</a> <strong><strong>2.8 比较、运算、类型等操作</strong></strong></h2> <h3 id="eq"><a href="#eq" class="header-anchor">#</a> <code>__eq__</code></h3> <p>通过定义各类比较、运算、类型相关的魔法方法，来实现对象之间的各类比较、运算等操作。这类魔法方法非常多，不一一展开，以<code>__eq__</code> 魔法方法举例说明，如果自定义的对象要实现==的比较功能，则必须在类中实现<code>__eq__</code>：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment">#__eq__ 方法，可以判断两个对象是否相等</span>
<span class="token keyword">class</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>a<span class="token operator">=</span>a
        self<span class="token punctuation">.</span>b<span class="token operator">=</span>b
    <span class="token keyword">def</span> <span class="token function">__eq__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> other<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#这里并没有重写，只是加了一句Print来监控；还是调用的Objecgt的__eq__</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'eq'</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__eq__<span class="token punctuation">(</span>other<span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>x<span class="token operator">=</span>A<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>y<span class="token operator">=</span>A<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span><span class="token keyword">print</span><span class="token punctuation">(</span>x <span class="token operator">==</span> y<span class="token punctuation">)</span><span class="token comment">#如果未定义，则这两个对象就算里面的属性和方法都相同，但仍会返回False</span>
eq
eq<span class="token comment">#返回两个应该和x与y都调用了有关</span>
<span class="token boolean">False</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span><span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span>__eq__<span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#单向x调用；因为最终仍是调用object的__eq__</span>
NotImplemented
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>自定义<code>__eq__</code>:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>a <span class="token operator">=</span> a
        self<span class="token punctuation">.</span>b <span class="token operator">=</span> b

    <span class="token keyword">def</span> <span class="token function">__eq__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> other<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'eq'</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>a <span class="token operator">==</span> other<span class="token punctuation">.</span>a<span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token boolean">True</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token boolean">False</span>

x <span class="token operator">=</span> A<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> A<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>x <span class="token operator">==</span> y<span class="token punctuation">)</span>  <span class="token comment"># 只要两个实例的a属性相同即返回True</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span>__eq__<span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token triple-quoted-string string">&quot;&quot;&quot;
eq
True
eq
True
&quot;&quot;&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h3 id="int"><a href="#int" class="header-anchor">#</a> <code>__int__</code></h3> <p>再举一个<code>__int__</code>的类型转换的魔法方法</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>a <span class="token operator">=</span> a
        self<span class="token punctuation">.</span>b <span class="token operator">=</span> b

x <span class="token operator">=</span> A<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>

<span class="token comment"># int(x)  # 未定义__int__，就只能按默认的int对象来转换，里面必须为string，float这类；</span>

<span class="token keyword">class</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>a <span class="token operator">=</span> a
        self<span class="token punctuation">.</span>b <span class="token operator">=</span> b

    <span class="token keyword">def</span> <span class="token function">__int__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token builtin">int</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>a<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 必须返回为int数字</span>

x <span class="token operator">=</span> A<span class="token punctuation">(</span><span class="token string">'345_hhh'</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token triple-quoted-string string">&quot;&quot;&quot;
345
&quot;&quot;&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>其它的比较、运算、类型等魔法方法如下：</p> <p>其它的比较、运算、类型等魔法方法如下：</p> <ol><li>用于比较的魔法方法</li></ol> <p><a href="https://segmentfault.com/img/bVcTcD8" target="_blank" rel="noopener noreferrer">https://segmentfault.com/img/bVcTcD8<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ol><li>双目运算符或函数</li></ol> <p><a href="https://segmentfault.com/img/bVcTcD6" target="_blank" rel="noopener noreferrer">https://segmentfault.com/img/bVcTcD6<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ol><li>增量运算</li></ol> <p><a href="https://segmentfault.com/img/bVcTcD3" target="_blank" rel="noopener noreferrer">https://segmentfault.com/img/bVcTcD3<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ol><li>类型转换</li></ol> <p><a href="https://segmentfault.com/img/bVcTcD1" target="_blank" rel="noopener noreferrer">https://segmentfault.com/img/bVcTcD1<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="总结"><a href="#总结" class="header-anchor">#</a> <strong>总结</strong></h3> <p>这篇文章较为详细的阐述了python中的各类魔法方法及相关demo；但这类方法在python的文档中较为分散，最重要的是鲜有实际的工程示例。但各类方法只有有实际的案例中才会真正体会到其“魔法”之处，比如大大简化代码，提高代码可读性、健壮性等等。在python一些第三方库中，查其源码都可以见到非常多的魔法方法的实际应用，因此当前这篇文章仅是抛砖引玉，真正的使用需要在开源的优秀源码中以及自身的工程实践中不断加深理解并合适应用。</p> <p>部分参考：</p> <p><a href="https://link.segmentfault.com/?enc=NK2UkKBqC8dSRul%2B4zR4cQ%3D%3D.%2F6cxuxTHAQY9bS6GQYfsYjeFZhtz3xuRtLLB9b68rXgG8ABY8HYmUyQ96EliN4JHHllbU6A92K2YU6Dfj7F4Sw%3D%3D" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/weixin_...<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://link.segmentfault.com/?enc=b2Mz1bPlPoXoWAbZdHRPng%3D%3D.p5qleailKxGoGFWxXxR21Vmy1fG%2B11lzJO9v0PjwoWYOHtndJVNivAyBcVOrOnuA" target="_blank" rel="noopener noreferrer">https://zhuanlan.zhihu.com/p/...<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://link.segmentfault.com/?enc=OHn0%2FsHqNhAgr0aaAKn0xQ%3D%3D.q%2Byp3GbvejP7hgilBsPINaFas5QLH6mlkCHEdu%2Fz%2BX%2FhrxZFEyaTj9Ey%2FWWUHNkk" target="_blank" rel="noopener noreferrer">https://zhuanlan.zhihu.com/p/...<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://link.segmentfault.com/?enc=eHNy01rTJU%2ByR9kMuItWmw%3D%3D.wYG5R9HJSaYciIM%2BPpZTz7%2Bip30WJQJbn77lU30kCg0M7f2OP8FP91aUmV8tmf4I" target="_blank" rel="noopener noreferrer">https://zhuanlan.zhihu.com/p/...<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div></div> <!----> <div class="page-edit"><div class="edit-link"><a href="https://github.com/YiZhang-You/edit/master/docs/02.python/01.python基础/08.python面向对象/10.python魔法方法.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2023/05/17, 23:08:21</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/ddb850/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">python中的super()</div></a> <a href="/pages/068c18/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">模块与包</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/ddb850/" class="prev">python中的super()</a></span> <span class="next"><a href="/pages/068c18/">模块与包</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/b7d5ce/"><div>
            配置yun源
            <!----></div></a> <span class="date">05-24</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/fc9319/"><div>
            linux-配置python虚拟环境
            <!----></div></a> <span class="date">05-24</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/d5b367/"><div>
            linux文件目录管理
            <!----></div></a> <span class="date">05-24</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="yyz18071720400@163.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/YiZhang-You" title="GitHub" target="_blank" class="iconfont icon-github"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2023-2023
    <span>yizhang | <a href="https://github.com/YiZhang-You/pymongoRawQuery" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.4d9762f5.js" defer></script><script src="/assets/js/2.eb47357b.js" defer></script><script src="/assets/js/151.a8a53689.js" defer></script>
  </body>
</html>
